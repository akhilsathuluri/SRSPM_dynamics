#include<iostream>
#include<Eigen/Dense>
#include <stdio.h>
#include <gsl/gsl_linalg.h>


using namespace Eigen;

#define coords 24
#define passive 18
#define active 6


//Fixed Dimension Linear Solve
VectorXd LinearSolve2(MatrixXd Amat, VectorXd bvec){
  // Transposing so that a_dat gets the right sequence
  Amat.transposeInPlace();
  double *a_data = Amat.data(), *b_data=bvec.data();
  gsl_matrix_view m
    = gsl_matrix_view_array (a_data, active, active);

  gsl_vector_view b
    = gsl_vector_view_array (b_data, active);

  gsl_vector *x = gsl_vector_alloc (active);

  int s;

  gsl_permutation * p = gsl_permutation_alloc (active);

  gsl_linalg_LU_decomp (&m.matrix, p, &s);

  gsl_linalg_LU_solve (&m.matrix, p, &b.vector, x);

  VectorXd xval(active);
  for (size_t i = 0; i < active; i++) {
    xval(i) = gsl_vector_get(x, i);
  }

  gsl_permutation_free (p);
  gsl_vector_free (x);
  return xval;
}


//Fixed Dimension Linear Solve
VectorXd LinearSolve(MatrixXd Amat, VectorXd bvec){
  // Transposing so that a_dat gets the right sequence
  Amat.transposeInPlace();
  double *a_data = Amat.data(), *b_data=bvec.data();
  gsl_matrix_view m
    = gsl_matrix_view_array (a_data, passive, passive);

  gsl_vector_view b
    = gsl_vector_view_array (b_data, passive);

  gsl_vector *x = gsl_vector_alloc (passive);

  int s;

  gsl_permutation * p = gsl_permutation_alloc (passive);

  gsl_linalg_LU_decomp (&m.matrix, p, &s);

  gsl_linalg_LU_solve (&m.matrix, p, &b.vector, x);

  VectorXd xval(passive);
  for (size_t i = 0; i < passive; i++) {
    xval(i) = gsl_vector_get(x, i);
  }

  gsl_permutation_free (p);
  gsl_vector_free (x);
  return xval;
}

// Mass Matrix
MatrixXd Mmat(VectorXd vals){
double p1=vals(0), p2=vals(1), p3=vals(2), p4=vals(3), p5=vals(4), p6=vals(5),s1=vals(6), s2=vals(7), s3=vals(8), s4=vals(9), s5=vals(10), \
s6=vals(11), l1=vals(12), l2=vals(13), l3=vals(14), l4=vals(15), l5=vals(16), \
l6=vals(17), x=vals(18), y=vals(19), z=vals(20), c1=vals(21), c2=vals(22), \
c3=vals(23);
double cs21=cos(2*s1), cs22=cos(2*s2), cs23=cos(2*s3), cs24=cos(2*s4), cs25=cos(2*s5), \
cs26=cos(2*s6);
MatrixXd Mval(coords, coords);
Mval << 0.20339, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.20339, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.20339, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., (4.68688 + 9.372404*pow(c2,2) + 4.68688*pow(c3,2))*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-2), 0. - 9.372404*c1*c2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2), (4.685523999999999*c2 - 4.68688*c1*c3)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-2), 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0. - 9.372404*c1*c2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2), (4.68688 + 9.372404*pow(c1,2) + 4.68688*pow(c3,2))*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-2), (-4.685523999999999*c1 - 4.68688*c2*c3)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-2), 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., (4.685523999999999*c2 - 4.68688*c1*c3)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-2), (-4.685523999999999*c1 - 4.68688*c2*c3)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-2), (9.372404 + 4.68688*pow(c1,2) + 4.68688*pow(c2,2))*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-2), 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 4.30248355412111 - 8.505317239618508*l1 + 5.670211493079005*pow(l1,2) + cs21*(4.300338420538397 - 8.505317239618508*l1 + 5.670211493079005*pow(l1,2)), 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 4.30248355412111 - 8.505317239618508*l2 + 5.670211493079005*pow(l2,2) + cs22*(4.300338420538397 - 8.505317239618508*l2 + 5.670211493079005*pow(l2,2)), 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 4.30248355412111 - 8.505317239618508*l3 + 5.670211493079005*pow(l3,2) + cs23*(4.300338420538397 - 8.505317239618508*l3 + 5.670211493079005*pow(l3,2)), 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 4.30248355412111 - 8.505317239618508*l4 + 5.670211493079005*pow(l4,2) + cs24*(4.300338420538397 - 8.505317239618508*l4 + 5.670211493079005*pow(l4,2)), 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 4.30248355412111 - 8.505317239618508*l5 + 5.670211493079005*pow(l5,2) + cs25*(4.300338420538397 - 8.505317239618508*l5 + 5.670211493079005*pow(l5,2)), 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 4.30248355412111 - 8.505317239618508*l6 + 5.670211493079005*pow(l6,2) + cs26*(4.300338420538397 - 8.505317239618508*l6 + 5.670211493079005*pow(l6,2)), 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 8.602821974659507 - 17.010634479237016*l1 + 11.34042298615801*pow(l1,2), 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 8.602821974659507 - 17.010634479237016*l2 + 11.34042298615801*pow(l2,2), 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 8.602821974659507 - 17.010634479237016*l3 + 11.34042298615801*pow(l3,2), 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 8.602821974659507 - 17.010634479237016*l4 + 11.34042298615801*pow(l4,2), 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 8.602821974659507 - 17.010634479237016*l5 + 11.34042298615801*pow(l5,2), 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 8.602821974659507 - 17.010634479237016*l6 + 11.34042298615801*pow(l6,2), 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 11.34042298615801, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 11.34042298615801, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 11.34042298615801, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 11.34042298615801, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 11.34042298615801, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 11.34042298615801;
return Mval;
}

// C matrix
MatrixXd Cmat(VectorXd vals, VectorXd dvals){
double p1=vals(0), p2=vals(1), p3=vals(2), p4=vals(3), p5=vals(4), p6=vals(5),s1=vals(6), s2=vals(7), s3=vals(8), s4=vals(9), s5=vals(10), \
s6=vals(11), l1=vals(12), l2=vals(13), l3=vals(14), l4=vals(15), l5=vals(16), \
l6=vals(17), x=vals(18), y=vals(19), z=vals(20), c1=vals(21), c2=vals(22), \
c3=vals(23), dp1=dvals(0), dp2=dvals(1), dp3=dvals(2), dp4=dvals(3), dp5=dvals(4), dp6=dvals(5),ds1=dvals(6), ds2=dvals(7), ds3=dvals(8), ds4=dvals(9), ds5=dvals(10), \
ds6=dvals(11), dl1=dvals(12), dl2=dvals(13), dl3=dvals(14), dl4=dvals(15), dl5=dvals(16), \
dl6=dvals(17), dx=dvals(18), dy=dvals(19), dz=dvals(20), dc1=dvals(21), dc2=dvals(22), \
dc3=dvals(23);
double cs1=cos(s1), cs2=cos(s2), cs3=cos(s3), cs4=cos(s4), cs5=cos(s5), \
cs6=cos(s6), ss1=sin(s1), ss2=sin(s2), ss3=sin(s3), ss4=sin(s4), ss5=sin(s5), \
ss6=sin(s6);
MatrixXd Cval(coords, coords);
Cval << 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0. - 9.37376*c1*dc1*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 9.37376*c2*dc2*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 4.68688*c3*dc3*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 4.68688*c3*dc3*pow(c1,2)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 18.744808*c1*dc1*pow(c2,2)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 14.057927999999999*c3*dc3*pow(c2,2)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 18.744808*dc2*pow(c2,3)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 9.37376*c1*dc1*pow(c3,2)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 9.37376*c2*dc2*pow(c3,2)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 4.68688*dc3*pow(c3,3)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 9.372404*c2*dc2*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-2), 0. - 9.37376*c2*dc1*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 9.371047999999998*c1*dc2*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 4.685523999999999*dc3*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 18.744808*c1*c2*c3*dc3*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 4.685523999999999*dc3*pow(c1,2)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 18.744808*c1*dc2*pow(c2,2)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 4.685523999999999*dc3*pow(c2,2)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 18.744808*dc1*pow(c2,3)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 9.37376*c2*dc1*pow(c3,2)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 9.371047999999998*c1*dc2*pow(c3,2)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 4.685523999999999*dc3*pow(c3,2)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 9.372404*c2*dc1*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-2), -4.68688*c3*dc1*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 4.685523999999999*dc2*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 18.744808*c1*c2*c3*dc2*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 9.371047999999998*c1*dc3*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 18.742095999999997*c2*c3*dc3*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 4.68688*c3*dc1*pow(c1,2)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 4.685523999999999*dc2*pow(c1,2)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 14.057927999999999*c3*dc1*pow(c2,2)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 4.685523999999999*dc2*pow(c2,2)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 4.685523999999999*dc2*pow(c3,2)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 9.37376*c1*dc3*pow(c3,2)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 4.68688*dc1*pow(c3,3)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0. - 9.371047999999998*c2*dc1*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 9.37376*c1*dc2*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 4.685523999999999*dc3*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 18.744808*c1*c2*c3*dc3*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 18.744808*c2*dc1*pow(c1,2)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 4.685523999999999*dc3*pow(c1,2)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 18.744808*dc2*pow(c1,3)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 4.685523999999999*dc3*pow(c2,2)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 9.371047999999998*c2*dc1*pow(c3,2)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 9.37376*c1*dc2*pow(c3,2)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 4.685523999999999*dc3*pow(c3,2)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 9.372404*c1*dc2*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-2), 0. - 9.37376*c1*dc1*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 9.37376*c2*dc2*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 4.68688*c3*dc3*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 18.744808*c2*dc2*pow(c1,2)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 14.057928*c3*dc3*pow(c1,2)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 18.744808*dc1*pow(c1,3)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 4.68688*c3*dc3*pow(c2,2)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 9.37376*c1*dc1*pow(c3,2)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 9.37376*c2*dc2*pow(c3,2)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 4.68688*dc3*pow(c3,3)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 9.372404*c1*dc1*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-2), -4.685523999999999*dc1*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 18.744808*c1*c2*c3*dc1*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 4.68688*c3*dc2*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 9.371047999999998*c2*dc3*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 18.742095999999997*c1*c3*dc3*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 4.685523999999999*dc1*pow(c1,2)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 14.057927999999999*c3*dc2*pow(c1,2)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 4.685523999999999*dc1*pow(c2,2)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 4.68688*c3*dc2*pow(c2,2)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 4.685523999999999*dc1*pow(c3,2)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 9.37376*c2*dc3*pow(c3,2)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 4.68688*dc2*pow(c3,3)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0. - 18.742095999999997*c1*c2*dc1*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 0.0027120000000024898*c1*c2*c3*dc2*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 14.057927999999999*c1*dc3*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 9.37376*c3*dc1*pow(c1,2)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 9.371047999999998*dc2*pow(c1,2)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 4.68688*dc3*pow(c1,3)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 9.371047999999998*c3*dc1*pow(c2,2)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 9.371047999999998*dc2*pow(c2,2)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 4.68688*c1*dc3*pow(c2,2)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 4.68688*c1*dc3*pow(c3,2)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3), 0. + 0.00271200000000249*c1*c2*c3*dc1*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 18.742095999999997*c1*c2*dc2*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 14.057927999999999*c2*dc3*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 9.371047999999998*dc1*pow(c1,2)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 9.371047999999998*c3*dc2*pow(c1,2)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 4.68688*c2*dc3*pow(c1,2)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 9.371047999999998*dc1*pow(c2,2)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 9.37376*c3*dc2*pow(c2,2)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 4.68688*dc3*pow(c2,3)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 4.68688*c2*dc3*pow(c3,2)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3), -14.057927999999999*c1*dc1*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 14.057927999999999*c2*dc2*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 18.744808*c3*dc3*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 4.68688*c2*dc2*pow(c1,2)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 9.37376*c3*dc3*pow(c1,2)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 4.68688*dc1*pow(c1,3)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 4.68688*c1*dc1*pow(c2,2)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 9.37376*c3*dc3*pow(c2,2)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 4.68688*dc2*pow(c2,3)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 4.68688*c1*dc1*pow(c3,2)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 4.68688*c2*dc2*pow(c3,2)*pow(1. + pow(c1,2) + pow(c2,2) + pow(c3,2),-3), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0. - 4.252658619809254*dl1 + 5.670211493079005*dl1*l1 - 8.600676841076794*cs1*ds1*ss1 + 17.010634479237016*cs1*ds1*l1*ss1 - 4.252658619809254*dl1*pow(cs1,2) + 5.670211493079005*dl1*l1*pow(cs1,2) - 11.34042298615801*cs1*ds1*ss1*pow(l1,2) + 4.252658619809254*dl1*pow(ss1,2) - 5.670211493079005*dl1*l1*pow(ss1,2), 0, 0, 0, 0, 0, 0. - 8.600676841076794*cs1*dp1*ss1 + 17.010634479237016*cs1*dp1*l1*ss1 - 11.34042298615801*cs1*dp1*ss1*pow(l1,2), 0, 0, 0, 0, 0, 0. - 4.252658619809254*dp1 + 5.670211493079005*dp1*l1 - 4.252658619809254*dp1*pow(cs1,2) + 5.670211493079005*dp1*l1*pow(cs1,2) + 4.252658619809254*dp1*pow(ss1,2) - 5.670211493079005*dp1*l1*pow(ss1,2), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0. - 4.252658619809254*dl2 + 5.670211493079005*dl2*l2 - 8.600676841076794*cs2*ds2*ss2 + 17.010634479237016*cs2*ds2*l2*ss2 - 4.252658619809254*dl2*pow(cs2,2) + 5.670211493079005*dl2*l2*pow(cs2,2) - 11.34042298615801*cs2*ds2*ss2*pow(l2,2) + 4.252658619809254*dl2*pow(ss2,2) - 5.670211493079005*dl2*l2*pow(ss2,2), 0, 0, 0, 0, 0, 0. - 8.600676841076794*cs2*dp2*ss2 + 17.010634479237016*cs2*dp2*l2*ss2 - 11.34042298615801*cs2*dp2*ss2*pow(l2,2), 0, 0, 0, 0, 0, 0. - 4.252658619809254*dp2 + 5.670211493079005*dp2*l2 - 4.252658619809254*dp2*pow(cs2,2) + 5.670211493079005*dp2*l2*pow(cs2,2) + 4.252658619809254*dp2*pow(ss2,2) - 5.670211493079005*dp2*l2*pow(ss2,2), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0. - 4.252658619809254*dl3 + 5.670211493079005*dl3*l3 - 8.600676841076794*cs3*ds3*ss3 + 17.010634479237016*cs3*ds3*l3*ss3 - 4.252658619809254*dl3*pow(cs3,2) + 5.670211493079005*dl3*l3*pow(cs3,2) - 11.34042298615801*cs3*ds3*ss3*pow(l3,2) + 4.252658619809254*dl3*pow(ss3,2) - 5.670211493079005*dl3*l3*pow(ss3,2), 0, 0, 0, 0, 0, 0. - 8.600676841076794*cs3*dp3*ss3 + 17.010634479237016*cs3*dp3*l3*ss3 - 11.34042298615801*cs3*dp3*ss3*pow(l3,2), 0, 0, 0, 0, 0, 0. - 4.252658619809254*dp3 + 5.670211493079005*dp3*l3 - 4.252658619809254*dp3*pow(cs3,2) + 5.670211493079005*dp3*l3*pow(cs3,2) + 4.252658619809254*dp3*pow(ss3,2) - 5.670211493079005*dp3*l3*pow(ss3,2), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0. - 4.252658619809254*dl4 + 5.670211493079005*dl4*l4 - 8.600676841076794*cs4*ds4*ss4 + 17.010634479237016*cs4*ds4*l4*ss4 - 4.252658619809254*dl4*pow(cs4,2) + 5.670211493079005*dl4*l4*pow(cs4,2) - 11.34042298615801*cs4*ds4*ss4*pow(l4,2) + 4.252658619809254*dl4*pow(ss4,2) - 5.670211493079005*dl4*l4*pow(ss4,2), 0, 0, 0, 0, 0, 0. - 8.600676841076794*cs4*dp4*ss4 + 17.010634479237016*cs4*dp4*l4*ss4 - 11.34042298615801*cs4*dp4*ss4*pow(l4,2), 0, 0, 0, 0, 0, 0. - 4.252658619809254*dp4 + 5.670211493079005*dp4*l4 - 4.252658619809254*dp4*pow(cs4,2) + 5.670211493079005*dp4*l4*pow(cs4,2) + 4.252658619809254*dp4*pow(ss4,2) - 5.670211493079005*dp4*l4*pow(ss4,2), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0. - 4.252658619809254*dl5 + 5.670211493079005*dl5*l5 - 8.600676841076794*cs5*ds5*ss5 + 17.010634479237016*cs5*ds5*l5*ss5 - 4.252658619809254*dl5*pow(cs5,2) + 5.670211493079005*dl5*l5*pow(cs5,2) - 11.34042298615801*cs5*ds5*ss5*pow(l5,2) + 4.252658619809254*dl5*pow(ss5,2) - 5.670211493079005*dl5*l5*pow(ss5,2), 0, 0, 0, 0, 0, 0. - 8.600676841076794*cs5*dp5*ss5 + 17.010634479237016*cs5*dp5*l5*ss5 - 11.34042298615801*cs5*dp5*ss5*pow(l5,2), 0, 0, 0, 0, 0, 0. - 4.252658619809254*dp5 + 5.670211493079005*dp5*l5 - 4.252658619809254*dp5*pow(cs5,2) + 5.670211493079005*dp5*l5*pow(cs5,2) + 4.252658619809254*dp5*pow(ss5,2) - 5.670211493079005*dp5*l5*pow(ss5,2), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0. - 4.252658619809254*dl6 + 5.670211493079005*dl6*l6 - 8.600676841076794*cs6*ds6*ss6 + 17.010634479237016*cs6*ds6*l6*ss6 - 4.252658619809254*dl6*pow(cs6,2) + 5.670211493079005*dl6*l6*pow(cs6,2) - 11.34042298615801*cs6*ds6*ss6*pow(l6,2) + 4.252658619809254*dl6*pow(ss6,2) - 5.670211493079005*dl6*l6*pow(ss6,2), 0, 0, 0, 0, 0, 0. - 8.600676841076794*cs6*dp6*ss6 + 17.010634479237016*cs6*dp6*l6*ss6 - 11.34042298615801*cs6*dp6*ss6*pow(l6,2), 0, 0, 0, 0, 0, 0. - 4.252658619809254*dp6 + 5.670211493079005*dp6*l6 - 4.252658619809254*dp6*pow(cs6,2) + 5.670211493079005*dp6*l6*pow(cs6,2) + 4.252658619809254*dp6*pow(ss6,2) - 5.670211493079005*dp6*l6*pow(ss6,2), 0, 0, 0, 0, 0, 0, 0. + 8.600676841076794*cs1*dp1*ss1 - 17.010634479237016*cs1*dp1*l1*ss1 + 11.34042298615801*cs1*dp1*ss1*pow(l1,2), 0, 0, 0, 0, 0, -8.505317239618508*dl1 + 11.34042298615801*dl1*l1, 0, 0, 0, 0, 0, -8.505317239618508*ds1 + 11.34042298615801*ds1*l1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0. + 8.600676841076794*cs2*dp2*ss2 - 17.010634479237016*cs2*dp2*l2*ss2 + 11.34042298615801*cs2*dp2*ss2*pow(l2,2), 0, 0, 0, 0, 0, -8.505317239618508*dl2 + 11.34042298615801*dl2*l2, 0, 0, 0, 0, 0, -8.505317239618508*ds2 + 11.34042298615801*ds2*l2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0. + 8.600676841076794*cs3*dp3*ss3 - 17.010634479237016*cs3*dp3*l3*ss3 + 11.34042298615801*cs3*dp3*ss3*pow(l3,2), 0, 0, 0, 0, 0, -8.505317239618508*dl3 + 11.34042298615801*dl3*l3, 0, 0, 0, 0, 0, -8.505317239618508*ds3 + 11.34042298615801*ds3*l3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0. + 8.600676841076794*cs4*dp4*ss4 - 17.010634479237016*cs4*dp4*l4*ss4 + 11.34042298615801*cs4*dp4*ss4*pow(l4,2), 0, 0, 0, 0, 0, -8.505317239618508*dl4 + 11.34042298615801*dl4*l4, 0, 0, 0, 0, 0, -8.505317239618508*ds4 + 11.34042298615801*ds4*l4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0. + 8.600676841076794*cs5*dp5*ss5 - 17.010634479237016*cs5*dp5*l5*ss5 + 11.34042298615801*cs5*dp5*ss5*pow(l5,2), 0, 0, 0, 0, 0, -8.505317239618508*dl5 + 11.34042298615801*dl5*l5, 0, 0, 0, 0, 0, -8.505317239618508*ds5 + 11.34042298615801*ds5*l5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0. + 8.600676841076794*cs6*dp6*ss6 - 17.010634479237016*cs6*dp6*l6*ss6 + 11.34042298615801*cs6*dp6*ss6*pow(l6,2), 0, 0, 0, 0, 0, -8.505317239618508*dl6 + 11.34042298615801*dl6*l6, 0, 0, 0, 0, 0, -8.505317239618508*ds6 + 11.34042298615801*ds6*l6, 0, 0, 0, 0, 0, 0, 0. + 4.252658619809254*dp1 - 5.670211493079005*dp1*l1 + 4.252658619809254*dp1*pow(cs1,2) - 5.670211493079005*dp1*l1*pow(cs1,2) - 4.252658619809254*dp1*pow(ss1,2) + 5.670211493079005*dp1*l1*pow(ss1,2), 0, 0, 0, 0, 0, 8.505317239618508*ds1 - 11.34042298615801*ds1*l1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0. + 4.252658619809254*dp2 - 5.670211493079005*dp2*l2 + 4.252658619809254*dp2*pow(cs2,2) - 5.670211493079005*dp2*l2*pow(cs2,2) - 4.252658619809254*dp2*pow(ss2,2) + 5.670211493079005*dp2*l2*pow(ss2,2), 0, 0, 0, 0, 0, 8.505317239618508*ds2 - 11.34042298615801*ds2*l2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0. + 4.252658619809254*dp3 - 5.670211493079005*dp3*l3 + 4.252658619809254*dp3*pow(cs3,2) - 5.670211493079005*dp3*l3*pow(cs3,2) - 4.252658619809254*dp3*pow(ss3,2) + 5.670211493079005*dp3*l3*pow(ss3,2), 0, 0, 0, 0, 0, 8.505317239618508*ds3 - 11.34042298615801*ds3*l3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0. + 4.252658619809254*dp4 - 5.670211493079005*dp4*l4 + 4.252658619809254*dp4*pow(cs4,2) - 5.670211493079005*dp4*l4*pow(cs4,2) - 4.252658619809254*dp4*pow(ss4,2) + 5.670211493079005*dp4*l4*pow(ss4,2), 0, 0, 0, 0, 0, 8.505317239618508*ds4 - 11.34042298615801*ds4*l4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0. + 4.252658619809254*dp5 - 5.670211493079005*dp5*l5 + 4.252658619809254*dp5*pow(cs5,2) - 5.670211493079005*dp5*l5*pow(cs5,2) - 4.252658619809254*dp5*pow(ss5,2) + 5.670211493079005*dp5*l5*pow(ss5,2), 0, 0, 0, 0, 0, 8.505317239618508*ds5 - 11.34042298615801*ds5*l5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0. + 4.252658619809254*dp6 - 5.670211493079005*dp6*l6 + 4.252658619809254*dp6*pow(cs6,2) - 5.670211493079005*dp6*l6*pow(cs6,2) - 4.252658619809254*dp6*pow(ss6,2) + 5.670211493079005*dp6*l6*pow(ss6,2), 0, 0, 0, 0, 0, 8.505317239618508*ds6 - 11.34042298615801*ds6*l6, 0, 0, 0, 0, 0, 0;
return Cval;
}

// Gravity Vector
VectorXd Gvec(VectorXd vals){
double p1=vals(0), p2=vals(1), p3=vals(2), p4=vals(3), p5=vals(4), p6=vals(5),s1=vals(6), s2=vals(7), s3=vals(8), s4=vals(9), s5=vals(10), \
s6=vals(11), l1=vals(12), l2=vals(13), l3=vals(14), l4=vals(15), l5=vals(16), \
l6=vals(17), x=vals(18), y=vals(19), z=vals(20), c1=vals(21), c2=vals(22), \
c3=vals(23);
double cs1=cos(s1), cs2=cos(s2), cs3=cos(s3), cs4=cos(s4), cs5=cos(s5), \
cs6=cos(s6), ss1=sin(s1), ss2=sin(s2), ss3=sin(s3), ss4=sin(s4), ss5=sin(s5), \
ss6=sin(s6), sp1=sin(p1), sp2=sin(p2), sp3=sin(p3), sp4=sin(p4), sp5=sin(p5), \
sp6=sin(p6), cp1=cos(p1), cp2=cos(p2), cp3=cos(p3), cp4=cos(p4), cp5=cos(p5), \
cp6=cos(p6);
VectorXd Gval(coords);
Gval << 0, 0, 1.993222, 0, 0, 0, -2.835105746539502*cs1*sp1 - 111.13614526434851*cs1*(-0.75 + l1)*sp1, -2.835105746539502*cs2*sp2 - 111.13614526434851*cs2*(-0.75 + l2)*sp2, -2.835105746539502*cs3*sp3 - 111.13614526434851*cs3*(-0.75 + l3)*sp3, -2.835105746539502*cs4*sp4 - 111.13614526434851*cs4*(-0.75 + l4)*sp4, -2.835105746539502*cs5*sp5 - 111.13614526434851*cs5*(-0.75 + l5)*sp5, -2.835105746539502*cs6*sp6 - 111.13614526434851*cs6*(-0.75 + l6)*sp6, -2.835105746539502*cp1*ss1 - 111.13614526434851*cp1*(-0.75 + l1)*ss1, -2.835105746539502*cp2*ss2 - 111.13614526434851*cp2*(-0.75 + l2)*ss2, -2.835105746539502*cp3*ss3 - 111.13614526434851*cp3*(-0.75 + l3)*ss3, -2.835105746539502*cp4*ss4 - 111.13614526434851*cp4*(-0.75 + l4)*ss4, -2.835105746539502*cp5*ss5 - 111.13614526434851*cp5*(-0.75 + l5)*ss5, -2.835105746539502*cp6*ss6 - 111.13614526434851*cp6*(-0.75 + l6)*ss6, 111.13614526434851*cp1*cs1, 111.13614526434851*cp2*cs2, 111.13614526434851*cp3*cs3, 111.13614526434851*cp4*cs4, 111.13614526434851*cp5*cs5, 111.13614526434851*cp6*cs6;
return Gval;
}

// dJetaqphi matrix
MatrixXd dJetaqphimat(VectorXd vals, VectorXd dvals){
double p1=vals(0), p2=vals(1), p3=vals(2), p4=vals(3), p5=vals(4), p6=vals(5),s1=vals(6), s2=vals(7), s3=vals(8), s4=vals(9), s5=vals(10), \
s6=vals(11), l1=vals(12), l2=vals(13), l3=vals(14), l4=vals(15), l5=vals(16), \
l6=vals(17), x=vals(18), y=vals(19), z=vals(20), c1=vals(21), c2=vals(22), \
c3=vals(23) , dp1=dvals(0), dp2=dvals(1), dp3=dvals(2), dp4=dvals(3), dp5=dvals(4), dp6=dvals(5),ds1=dvals(6), ds2=dvals(7), ds3=dvals(8), ds4=dvals(9), ds5=dvals(10), \
ds6=dvals(11), dl1=dvals(12), dl2=dvals(13), dl3=dvals(14), dl4=dvals(15), dl5=dvals(16), \
dl6=dvals(17), dx=dvals(18), dy=dvals(19), dz=dvals(20), dc1=dvals(21), dc2=dvals(22), \
dc3=dvals(23);
double cs1=cos(s1), cs2=cos(s2), cs3=cos(s3), cs4=cos(s4), cs5=cos(s5), \
cs6=cos(s6), ss1=sin(s1), ss2=sin(s2), ss3=sin(s3), ss4=sin(s4), ss5=sin(s5), \
ss6=sin(s6), sp1=sin(p1), sp2=sin(p2), sp3=sin(p3), sp4=sin(p4), sp5=sin(p5), \
sp6=sin(p6), cp1=cos(p1), cp2=cos(p2), cp3=cos(p3), cp4=cos(p4), cp5=cos(p5), \
cp6=cos(p6);
MatrixXd dJetaqphival(passive,passive);
dJetaqphival << 0, 0, 0, -0.8822733973287203*c1*(2*c1*c2 - 2*c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 2.1469893088616065*c1*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*(1 + pow(c1,2) - pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 0.44113669866436017*(2*c1*c2 - 2*c3)*dc1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.44113669866436017*c1*(2*c2*dc1 + 2*c1*dc2 - 2*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.0734946544308033*c1*(2*c1*dc1 - 2*c2*dc2 - 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.0734946544308033*c1*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.44113669866436017*c2*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.0734946544308033*dc1*(1 + pow(c1,2) - pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.0734946544308033*dc1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) - 0.44113669866436017*dc2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), -0.8822733973287203*c2*(2*c1*c2 - 2*c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 2.1469893088616065*c2*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*(1 + pow(c1,2) - pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 0.44113669866436017*(2*c1*c2 - 2*c3)*dc2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.44113669866436017*c2*(2*c2*dc1 + 2*c1*dc2 - 2*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.0734946544308033*c2*(2*c1*dc1 - 2*c2*dc2 - 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.44113669866436017*c1*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.0734946544308033*c2*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.0734946544308033*dc2*(1 + pow(c1,2) - pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.44113669866436017*dc1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) + 1.0734946544308033*dc2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), -0.8822733973287203*(2*c1*c2 - 2*c3)*c3*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 2.1469893088616065*c3*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*(1 + pow(c1,2) - pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 0.44113669866436017*c3*(2*c2*dc1 + 2*c1*dc2 - 2*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.44113669866436017*(2*c1*c2 - 2*c3)*dc3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.0734946544308033*c3*(2*c1*dc1 - 2*c2*dc2 - 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.44113669866436017*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.0734946544308033*c3*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.0734946544308033*dc3*(1 + pow(c1,2) - pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.0734946544308033*dc3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), cp1*cs1*dl1 - cs1*dp1*l1*sp1 - cp1*ds1*l1*ss1, 0, 0, 0, 0, 0, -(cs1*ds1*l1*sp1) - cp1*dp1*l1*ss1 - dl1*sp1*ss1, 0, 0, 0, 0, 0, 0, 0, 0, -4.293978617723213*c1*(c1*c2 + c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 0.8822733973287203*c1*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*(1 - pow(c1,2) + pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 2.1469893088616065*(c1*c2 + c3)*dc1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 2.1469893088616065*c1*(c2*dc1 + c1*dc2 + dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.44113669866436017*c1*(-2*c1*dc1 + 2*c2*dc2 - 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.44113669866436017*c1*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.0734946544308033*c2*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.44113669866436017*dc1*(1 - pow(c1,2) + pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.44113669866436017*dc1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) - 1.0734946544308033*dc2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), -4.293978617723213*c2*(c1*c2 + c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 0.8822733973287203*c2*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*(1 - pow(c1,2) + pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 2.1469893088616065*(c1*c2 + c3)*dc2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 2.1469893088616065*c2*(c2*dc1 + c1*dc2 + dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.44113669866436017*c2*(-2*c1*dc1 + 2*c2*dc2 - 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.0734946544308033*c1*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.44113669866436017*c2*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.44113669866436017*dc2*(1 - pow(c1,2) + pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.0734946544308033*dc1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) - 0.44113669866436017*dc2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), -4.293978617723213*c3*(c1*c2 + c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 0.8822733973287203*c3*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*(1 - pow(c1,2) + pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 2.1469893088616065*(c1*c2 + c3)*dc3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 2.1469893088616065*c3*(c2*dc1 + c1*dc2 + dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.44113669866436017*c3*(-2*c1*dc1 + 2*c2*dc2 - 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.0734946544308033*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.44113669866436017*c3*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.44113669866436017*dc3*(1 - pow(c1,2) + pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.44113669866436017*dc3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 0, 0, 0, 0, 0, 0, -(cs1*dl1) + ds1*l1*ss1, 0, 0, 0, 0, 0, 0, 0, 0, -4.293978617723213*c1*(-c2 + c1*c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 1.7645467946574407*c1*(c1 + c2*c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 2.1469893088616065*(-c2 + c1*c3)*dc1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.8822733973287203*(c1 + c2*c3)*dc1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 2.1469893088616065*c1*(c3*dc1 - dc2 + c1*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.8822733973287203*c1*(dc1 + c3*dc2 + c2*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.44113669866436017*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.0734946544308033*c3*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.0734946544308033*dc3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), -4.293978617723213*c2*(-c2 + c1*c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 1.7645467946574407*c2*(c1 + c2*c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 2.1469893088616065*(-c2 + c1*c3)*dc2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.8822733973287203*(c1 + c2*c3)*dc2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 2.1469893088616065*c2*(c3*dc1 - dc2 + c1*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.8822733973287203*c2*(dc1 + c3*dc2 + c2*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.0734946544308033*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.44113669866436017*c3*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.44113669866436017*dc3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), -4.293978617723213*c3*(-c2 + c1*c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 1.7645467946574407*c3*(c1 + c2*c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 2.1469893088616065*(-c2 + c1*c3)*dc3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.8822733973287203*(c1 + c2*c3)*dc3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 2.1469893088616065*c3*(c3*dc1 - dc2 + c1*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.8822733973287203*c3*(dc1 + c3*dc2 + c2*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.0734946544308033*c1*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.44113669866436017*c2*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.0734946544308033*dc1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) - 0.44113669866436017*dc2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), -(cp1*cs1*dp1*l1) - cs1*dl1*sp1 + ds1*l1*sp1*ss1, 0, 0, 0, 0, 0, -(cp1*cs1*ds1*l1) - cp1*dl1*ss1 + dp1*l1*sp1*ss1, 0, 0, 0, 0, 0, 0, 0, 0, -2.300483981792106*c1*(2*c1*c2 - 2*c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 0.30942347926092917*c1*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*(1 + pow(c1,2) - pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 1.150241990896053*(2*c1*c2 - 2*c3)*dc1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.150241990896053*c1*(2*c2*dc1 + 2*c1*dc2 - 2*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.15471173963046458*c1*(2*c1*dc1 - 2*c2*dc2 - 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.15471173963046458*c1*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.150241990896053*c2*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.15471173963046458*dc1*(1 + pow(c1,2) - pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.15471173963046458*dc1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) - 1.150241990896053*dc2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), -2.300483981792106*c2*(2*c1*c2 - 2*c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 0.30942347926092917*c2*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*(1 + pow(c1,2) - pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 1.150241990896053*(2*c1*c2 - 2*c3)*dc2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.150241990896053*c2*(2*c2*dc1 + 2*c1*dc2 - 2*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.15471173963046458*c2*(2*c1*dc1 - 2*c2*dc2 - 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.150241990896053*c1*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.15471173963046458*c2*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.15471173963046458*dc2*(1 + pow(c1,2) - pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.150241990896053*dc1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) - 0.15471173963046458*dc2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), -2.300483981792106*(2*c1*c2 - 2*c3)*c3*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 0.30942347926092917*c3*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*(1 + pow(c1,2) - pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 1.150241990896053*c3*(2*c2*dc1 + 2*c1*dc2 - 2*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.150241990896053*(2*c1*c2 - 2*c3)*dc3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.15471173963046458*c3*(2*c1*dc1 - 2*c2*dc2 - 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.150241990896053*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.15471173963046458*c3*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.15471173963046458*dc3*(1 + pow(c1,2) - pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.15471173963046458*dc3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 0, cp2*cs2*dl2 - cs2*dp2*l2*sp2 - cp2*ds2*l2*ss2, 0, 0, 0, 0, 0, -(cs2*ds2*l2*sp2) - cp2*dp2*l2*ss2 - dl2*sp2*ss2, 0, 0, 0, 0, 0, 0, 0, 0.6188469585218583*c1*(c1*c2 + c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 2.300483981792106*c1*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*(1 - pow(c1,2) + pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 0.30942347926092917*(c1*c2 + c3)*dc1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.30942347926092917*c1*(c2*dc1 + c1*dc2 + dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.150241990896053*c1*(-2*c1*dc1 + 2*c2*dc2 - 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.150241990896053*c1*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.15471173963046458*c2*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.150241990896053*dc1*(1 - pow(c1,2) + pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.150241990896053*dc1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) + 0.15471173963046458*dc2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 0.6188469585218583*c2*(c1*c2 + c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 2.300483981792106*c2*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*(1 - pow(c1,2) + pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 0.30942347926092917*(c1*c2 + c3)*dc2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.30942347926092917*c2*(c2*dc1 + c1*dc2 + dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.150241990896053*c2*(-2*c1*dc1 + 2*c2*dc2 - 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.15471173963046458*c1*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.150241990896053*c2*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.150241990896053*dc2*(1 - pow(c1,2) + pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.15471173963046458*dc1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) - 1.150241990896053*dc2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 0.6188469585218583*c3*(c1*c2 + c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 2.300483981792106*c3*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*(1 - pow(c1,2) + pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 0.30942347926092917*(c1*c2 + c3)*dc3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.30942347926092917*c3*(c2*dc1 + c1*dc2 + dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.150241990896053*c3*(-2*c1*dc1 + 2*c2*dc2 - 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.15471173963046458*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.150241990896053*c3*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.150241990896053*dc3*(1 - pow(c1,2) + pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.150241990896053*dc3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 0, 0, 0, 0, 0, 0, 0, -(cs2*dl2) + ds2*l2*ss2, 0, 0, 0, 0, 0, 0, 0, 0.6188469585218583*c1*(-c2 + c1*c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 4.600967963584212*c1*(c1 + c2*c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 0.30942347926092917*(-c2 + c1*c3)*dc1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 2.300483981792106*(c1 + c2*c3)*dc1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.30942347926092917*c1*(c3*dc1 - dc2 + c1*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 2.300483981792106*c1*(dc1 + c3*dc2 + c2*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.150241990896053*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.15471173963046458*c3*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.15471173963046458*dc3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 0.6188469585218583*c2*(-c2 + c1*c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 4.600967963584212*c2*(c1 + c2*c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 0.30942347926092917*(-c2 + c1*c3)*dc2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 2.300483981792106*(c1 + c2*c3)*dc2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.30942347926092917*c2*(c3*dc1 - dc2 + c1*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 2.300483981792106*c2*(dc1 + c3*dc2 + c2*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.15471173963046458*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.150241990896053*c3*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.150241990896053*dc3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 0.6188469585218583*c3*(-c2 + c1*c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 4.600967963584212*c3*(c1 + c2*c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 0.30942347926092917*(-c2 + c1*c3)*dc3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 2.300483981792106*(c1 + c2*c3)*dc3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.30942347926092917*c3*(c3*dc1 - dc2 + c1*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 2.300483981792106*c3*(dc1 + c3*dc2 + c2*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.15471173963046458*c1*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.150241990896053*c2*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.15471173963046458*dc1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) - 1.150241990896053*dc2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 0, -(cp2*cs2*dp2*l2) - cs2*dl2*sp2 + ds2*l2*sp2*ss2, 0, 0, 0, 0, 0, -(cp2*cs2*ds2*l2) - cp2*dl2*ss2 + dp2*l2*sp2*ss2, 0, 0, 0, 0, 0, 0, 0, -1.4182105844633854*c1*(2*c1*c2 - 2*c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 1.8375658296006767*c1*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*(1 + pow(c1,2) - pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 0.7091052922316927*(2*c1*c2 - 2*c3)*dc1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.7091052922316927*c1*(2*c2*dc1 + 2*c1*dc2 - 2*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.9187829148003384*c1*(2*c1*dc1 - 2*c2*dc2 - 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.9187829148003384*c1*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.7091052922316927*c2*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.9187829148003384*dc1*(1 + pow(c1,2) - pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.9187829148003384*dc1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) - 0.7091052922316927*dc2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), -1.4182105844633854*c2*(2*c1*c2 - 2*c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 1.8375658296006767*c2*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*(1 + pow(c1,2) - pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 0.7091052922316927*(2*c1*c2 - 2*c3)*dc2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.7091052922316927*c2*(2*c2*dc1 + 2*c1*dc2 - 2*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.9187829148003384*c2*(2*c1*dc1 - 2*c2*dc2 - 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.7091052922316927*c1*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.9187829148003384*c2*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.9187829148003384*dc2*(1 + pow(c1,2) - pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.7091052922316927*dc1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) - 0.9187829148003384*dc2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), -1.4182105844633854*(2*c1*c2 - 2*c3)*c3*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 1.8375658296006767*c3*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*(1 + pow(c1,2) - pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 0.7091052922316927*c3*(2*c2*dc1 + 2*c1*dc2 - 2*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.7091052922316927*(2*c1*c2 - 2*c3)*dc3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.9187829148003384*c3*(2*c1*dc1 - 2*c2*dc2 - 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.7091052922316927*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.9187829148003384*c3*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.9187829148003384*dc3*(1 + pow(c1,2) - pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.9187829148003384*dc3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 0, 0, cp3*cs3*dl3 - cs3*dp3*l3*sp3 - cp3*ds3*l3*ss3, 0, 0, 0, 0, 0, -(cs3*ds3*l3*sp3) - cp3*dp3*l3*ss3 - dl3*sp3*ss3, 0, 0, 0, 0, 0, 0, 3.6751316592013534*c1*(c1*c2 + c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 1.4182105844633854*c1*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*(1 - pow(c1,2) + pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 1.8375658296006767*(c1*c2 + c3)*dc1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.8375658296006767*c1*(c2*dc1 + c1*dc2 + dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.7091052922316927*c1*(-2*c1*dc1 + 2*c2*dc2 - 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.7091052922316927*c1*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.9187829148003384*c2*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.7091052922316927*dc1*(1 - pow(c1,2) + pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.7091052922316927*dc1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) + 0.9187829148003384*dc2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 3.6751316592013534*c2*(c1*c2 + c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 1.4182105844633854*c2*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*(1 - pow(c1,2) + pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 1.8375658296006767*(c1*c2 + c3)*dc2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.8375658296006767*c2*(c2*dc1 + c1*dc2 + dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.7091052922316927*c2*(-2*c1*dc1 + 2*c2*dc2 - 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.9187829148003384*c1*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.7091052922316927*c2*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.7091052922316927*dc2*(1 - pow(c1,2) + pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.9187829148003384*dc1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) - 0.7091052922316927*dc2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 3.6751316592013534*c3*(c1*c2 + c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 1.4182105844633854*c3*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*(1 - pow(c1,2) + pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 1.8375658296006767*(c1*c2 + c3)*dc3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.8375658296006767*c3*(c2*dc1 + c1*dc2 + dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.7091052922316927*c3*(-2*c1*dc1 + 2*c2*dc2 - 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.9187829148003384*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.7091052922316927*c3*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.7091052922316927*dc3*(1 - pow(c1,2) + pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.7091052922316927*dc3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 0, 0, 0, 0, 0, 0, 0, 0, -(cs3*dl3) + ds3*l3*ss3, 0, 0, 0, 0, 0, 0, 3.6751316592013534*c1*(-c2 + c1*c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 2.836421168926771*c1*(c1 + c2*c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 1.8375658296006767*(-c2 + c1*c3)*dc1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.4182105844633854*(c1 + c2*c3)*dc1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.8375658296006767*c1*(c3*dc1 - dc2 + c1*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.4182105844633854*c1*(dc1 + c3*dc2 + c2*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.7091052922316927*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.9187829148003384*c3*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.9187829148003384*dc3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 3.6751316592013534*c2*(-c2 + c1*c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 2.836421168926771*c2*(c1 + c2*c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 1.8375658296006767*(-c2 + c1*c3)*dc2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.4182105844633854*(c1 + c2*c3)*dc2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.8375658296006767*c2*(c3*dc1 - dc2 + c1*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.4182105844633854*c2*(dc1 + c3*dc2 + c2*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.9187829148003384*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.7091052922316927*c3*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.7091052922316927*dc3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 3.6751316592013534*c3*(-c2 + c1*c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 2.836421168926771*c3*(c1 + c2*c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 1.8375658296006767*(-c2 + c1*c3)*dc3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.4182105844633854*(c1 + c2*c3)*dc3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.8375658296006767*c3*(c3*dc1 - dc2 + c1*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.4182105844633854*c3*(dc1 + c3*dc2 + c2*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.9187829148003384*c1*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.7091052922316927*c2*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.9187829148003384*dc1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) - 0.7091052922316927*dc2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 0, 0, -(cp3*cs3*dp3*l3) - cs3*dl3*sp3 + ds3*l3*sp3*ss3, 0, 0, 0, 0, 0, -(cp3*cs3*ds3*l3) - cp3*dl3*ss3 + dp3*l3*sp3*ss3, 0, 0, 0, 0, 0, 0, 1.4182105844633854*c1*(2*c1*c2 - 2*c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 1.8375658296006776*c1*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*(1 + pow(c1,2) - pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 0.7091052922316927*(2*c1*c2 - 2*c3)*dc1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.7091052922316927*c1*(2*c2*dc1 + 2*c1*dc2 - 2*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.9187829148003388*c1*(2*c1*dc1 - 2*c2*dc2 - 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.9187829148003388*c1*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.7091052922316927*c2*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.9187829148003388*dc1*(1 + pow(c1,2) - pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.9187829148003388*dc1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) + 0.7091052922316927*dc2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 1.4182105844633854*c2*(2*c1*c2 - 2*c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 1.8375658296006776*c2*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*(1 + pow(c1,2) - pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 0.7091052922316927*(2*c1*c2 - 2*c3)*dc2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.7091052922316927*c2*(2*c2*dc1 + 2*c1*dc2 - 2*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.9187829148003388*c2*(2*c1*dc1 - 2*c2*dc2 - 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.7091052922316927*c1*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.9187829148003388*c2*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.9187829148003388*dc2*(1 + pow(c1,2) - pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.7091052922316927*dc1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) - 0.9187829148003388*dc2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 1.4182105844633854*(2*c1*c2 - 2*c3)*c3*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 1.8375658296006776*c3*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*(1 + pow(c1,2) - pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 0.7091052922316927*c3*(2*c2*dc1 + 2*c1*dc2 - 2*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.7091052922316927*(2*c1*c2 - 2*c3)*dc3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.9187829148003388*c3*(2*c1*dc1 - 2*c2*dc2 - 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.7091052922316927*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.9187829148003388*c3*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.9187829148003388*dc3*(1 + pow(c1,2) - pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.9187829148003388*dc3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 0, 0, 0, cp4*cs4*dl4 - cs4*dp4*l4*sp4 - cp4*ds4*l4*ss4, 0, 0, 0, 0, 0, -(cs4*ds4*l4*sp4) - cp4*dp4*l4*ss4 - dl4*sp4*ss4, 0, 0, 0, 0, 0, 3.675131659201355*c1*(c1*c2 + c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 1.4182105844633854*c1*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*(1 - pow(c1,2) + pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 1.8375658296006776*(c1*c2 + c3)*dc1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.8375658296006776*c1*(c2*dc1 + c1*dc2 + dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.7091052922316927*c1*(-2*c1*dc1 + 2*c2*dc2 - 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.7091052922316927*c1*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.9187829148003388*c2*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.7091052922316927*dc1*(1 - pow(c1,2) + pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.7091052922316927*dc1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) + 0.9187829148003388*dc2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 3.675131659201355*c2*(c1*c2 + c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 1.4182105844633854*c2*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*(1 - pow(c1,2) + pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 1.8375658296006776*(c1*c2 + c3)*dc2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.8375658296006776*c2*(c2*dc1 + c1*dc2 + dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.7091052922316927*c2*(-2*c1*dc1 + 2*c2*dc2 - 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.9187829148003388*c1*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.7091052922316927*c2*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.7091052922316927*dc2*(1 - pow(c1,2) + pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.9187829148003388*dc1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) + 0.7091052922316927*dc2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 3.675131659201355*c3*(c1*c2 + c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 1.4182105844633854*c3*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*(1 - pow(c1,2) + pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 1.8375658296006776*(c1*c2 + c3)*dc3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.8375658296006776*c3*(c2*dc1 + c1*dc2 + dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.7091052922316927*c3*(-2*c1*dc1 + 2*c2*dc2 - 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.9187829148003388*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.7091052922316927*c3*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.7091052922316927*dc3*(1 - pow(c1,2) + pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.7091052922316927*dc3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 0, 0, 0, 0, 0, 0, 0, 0, 0, -(cs4*dl4) + ds4*l4*ss4, 0, 0, 0, 0, 0, 3.675131659201355*c1*(-c2 + c1*c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 2.836421168926771*c1*(c1 + c2*c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 1.8375658296006776*(-c2 + c1*c3)*dc1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.4182105844633854*(c1 + c2*c3)*dc1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.8375658296006776*c1*(c3*dc1 - dc2 + c1*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.4182105844633854*c1*(dc1 + c3*dc2 + c2*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.7091052922316927*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.9187829148003388*c3*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.9187829148003388*dc3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 3.675131659201355*c2*(-c2 + c1*c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 2.836421168926771*c2*(c1 + c2*c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 1.8375658296006776*(-c2 + c1*c3)*dc2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.4182105844633854*(c1 + c2*c3)*dc2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.8375658296006776*c2*(c3*dc1 - dc2 + c1*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.4182105844633854*c2*(dc1 + c3*dc2 + c2*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.9187829148003388*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.7091052922316927*c3*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.7091052922316927*dc3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 3.675131659201355*c3*(-c2 + c1*c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 2.836421168926771*c3*(c1 + c2*c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 1.8375658296006776*(-c2 + c1*c3)*dc3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.4182105844633854*(c1 + c2*c3)*dc3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.8375658296006776*c3*(c3*dc1 - dc2 + c1*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.4182105844633854*c3*(dc1 + c3*dc2 + c2*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.9187829148003388*c1*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.7091052922316927*c2*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.9187829148003388*dc1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) + 0.7091052922316927*dc2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 0, 0, 0, -(cp4*cs4*dp4*l4) - cs4*dl4*sp4 + ds4*l4*sp4*ss4, 0, 0, 0, 0, 0, -(cp4*cs4*ds4*l4) - cp4*dl4*ss4 + dp4*l4*sp4*ss4, 0, 0, 0, 0, 0, 2.3004839817921057*c1*(2*c1*c2 - 2*c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 0.30942347926092983*c1*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*(1 + pow(c1,2) - pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 1.1502419908960528*(2*c1*c2 - 2*c3)*dc1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.1502419908960528*c1*(2*c2*dc1 + 2*c1*dc2 - 2*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.15471173963046492*c1*(2*c1*dc1 - 2*c2*dc2 - 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.15471173963046492*c1*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.1502419908960528*c2*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.15471173963046492*dc1*(1 + pow(c1,2) - pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.15471173963046492*dc1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) + 1.1502419908960528*dc2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 2.3004839817921057*c2*(2*c1*c2 - 2*c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 0.30942347926092983*c2*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*(1 + pow(c1,2) - pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 1.1502419908960528*(2*c1*c2 - 2*c3)*dc2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.1502419908960528*c2*(2*c2*dc1 + 2*c1*dc2 - 2*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.15471173963046492*c2*(2*c1*dc1 - 2*c2*dc2 - 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.1502419908960528*c1*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.15471173963046492*c2*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.15471173963046492*dc2*(1 + pow(c1,2) - pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.1502419908960528*dc1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) - 0.15471173963046492*dc2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 2.3004839817921057*(2*c1*c2 - 2*c3)*c3*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 0.30942347926092983*c3*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*(1 + pow(c1,2) - pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 1.1502419908960528*c3*(2*c2*dc1 + 2*c1*dc2 - 2*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.1502419908960528*(2*c1*c2 - 2*c3)*dc3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.15471173963046492*c3*(2*c1*dc1 - 2*c2*dc2 - 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.1502419908960528*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.15471173963046492*c3*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.15471173963046492*dc3*(1 + pow(c1,2) - pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.15471173963046492*dc3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 0, 0, 0, 0, cp5*cs5*dl5 - cs5*dp5*l5*sp5 - cp5*ds5*l5*ss5, 0, 0, 0, 0, 0, -(cs5*ds5*l5*sp5) - cp5*dp5*l5*ss5 - dl5*sp5*ss5, 0, 0, 0, 0, 0.6188469585218597*c1*(c1*c2 + c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 2.3004839817921057*c1*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*(1 - pow(c1,2) + pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 0.30942347926092983*(c1*c2 + c3)*dc1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.30942347926092983*c1*(c2*dc1 + c1*dc2 + dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.1502419908960528*c1*(-2*c1*dc1 + 2*c2*dc2 - 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.1502419908960528*c1*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.15471173963046492*c2*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.1502419908960528*dc1*(1 - pow(c1,2) + pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.1502419908960528*dc1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) + 0.15471173963046492*dc2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 0.6188469585218597*c2*(c1*c2 + c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 2.3004839817921057*c2*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*(1 - pow(c1,2) + pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 0.30942347926092983*(c1*c2 + c3)*dc2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.30942347926092983*c2*(c2*dc1 + c1*dc2 + dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.1502419908960528*c2*(-2*c1*dc1 + 2*c2*dc2 - 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.15471173963046492*c1*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.1502419908960528*c2*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.1502419908960528*dc2*(1 - pow(c1,2) + pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.15471173963046492*dc1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) + 1.1502419908960528*dc2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 0.6188469585218597*c3*(c1*c2 + c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 2.3004839817921057*c3*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*(1 - pow(c1,2) + pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 0.30942347926092983*(c1*c2 + c3)*dc3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.30942347926092983*c3*(c2*dc1 + c1*dc2 + dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.1502419908960528*c3*(-2*c1*dc1 + 2*c2*dc2 - 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.15471173963046492*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.1502419908960528*c3*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.1502419908960528*dc3*(1 - pow(c1,2) + pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.1502419908960528*dc3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -(cs5*dl5) + ds5*l5*ss5, 0, 0, 0, 0, 0.6188469585218597*c1*(-c2 + c1*c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 4.600967963584211*c1*(c1 + c2*c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 0.30942347926092983*(-c2 + c1*c3)*dc1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 2.3004839817921057*(c1 + c2*c3)*dc1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.30942347926092983*c1*(c3*dc1 - dc2 + c1*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 2.3004839817921057*c1*(dc1 + c3*dc2 + c2*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.1502419908960528*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.15471173963046492*c3*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.15471173963046492*dc3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 0.6188469585218597*c2*(-c2 + c1*c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 4.600967963584211*c2*(c1 + c2*c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 0.30942347926092983*(-c2 + c1*c3)*dc2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 2.3004839817921057*(c1 + c2*c3)*dc2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.30942347926092983*c2*(c3*dc1 - dc2 + c1*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 2.3004839817921057*c2*(dc1 + c3*dc2 + c2*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.15471173963046492*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.1502419908960528*c3*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.1502419908960528*dc3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 0.6188469585218597*c3*(-c2 + c1*c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 4.600967963584211*c3*(c1 + c2*c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 0.30942347926092983*(-c2 + c1*c3)*dc3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 2.3004839817921057*(c1 + c2*c3)*dc3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.30942347926092983*c3*(c3*dc1 - dc2 + c1*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 2.3004839817921057*c3*(dc1 + c3*dc2 + c2*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.15471173963046492*c1*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.1502419908960528*c2*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.15471173963046492*dc1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) + 1.1502419908960528*dc2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 0, 0, 0, 0, -(cp5*cs5*dp5*l5) - cs5*dl5*sp5 + ds5*l5*sp5*ss5, 0, 0, 0, 0, 0, -(cp5*cs5*ds5*l5) - cp5*dl5*ss5 + dp5*l5*sp5*ss5, 0, 0, 0, 0, 0.8822733973287209*c1*(2*c1*c2 - 2*c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 2.146989308861606*c1*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*(1 + pow(c1,2) - pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 0.44113669866436045*(2*c1*c2 - 2*c3)*dc1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.44113669866436045*c1*(2*c2*dc1 + 2*c1*dc2 - 2*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.073494654430803*c1*(2*c1*dc1 - 2*c2*dc2 - 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.073494654430803*c1*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.44113669866436045*c2*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.073494654430803*dc1*(1 + pow(c1,2) - pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.073494654430803*dc1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) + 0.44113669866436045*dc2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 0.8822733973287209*c2*(2*c1*c2 - 2*c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 2.146989308861606*c2*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*(1 + pow(c1,2) - pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 0.44113669866436045*(2*c1*c2 - 2*c3)*dc2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.44113669866436045*c2*(2*c2*dc1 + 2*c1*dc2 - 2*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.073494654430803*c2*(2*c1*dc1 - 2*c2*dc2 - 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.44113669866436045*c1*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.073494654430803*c2*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.073494654430803*dc2*(1 + pow(c1,2) - pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.44113669866436045*dc1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) + 1.073494654430803*dc2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 0.8822733973287209*(2*c1*c2 - 2*c3)*c3*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 2.146989308861606*c3*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*(1 + pow(c1,2) - pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) - 0.44113669866436045*c3*(2*c2*dc1 + 2*c1*dc2 - 2*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.44113669866436045*(2*c1*c2 - 2*c3)*dc3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.073494654430803*c3*(2*c1*dc1 - 2*c2*dc2 - 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.44113669866436045*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.073494654430803*c3*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.073494654430803*dc3*(1 + pow(c1,2) - pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.073494654430803*dc3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 0, 0, 0, 0, 0, cp6*cs6*dl6 - cs6*dp6*l6*sp6 - cp6*ds6*l6*ss6, 0, 0, 0, 0, 0, -(cs6*ds6*l6*sp6) - cp6*dp6*l6*ss6 - dl6*sp6*ss6, 0, 0, 0, -4.293978617723212*c1*(c1*c2 + c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 0.8822733973287209*c1*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*(1 - pow(c1,2) + pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 2.146989308861606*(c1*c2 + c3)*dc1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 2.146989308861606*c1*(c2*dc1 + c1*dc2 + dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.44113669866436045*c1*(-2*c1*dc1 + 2*c2*dc2 - 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.44113669866436045*c1*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.073494654430803*c2*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.44113669866436045*dc1*(1 - pow(c1,2) + pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.44113669866436045*dc1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) - 1.073494654430803*dc2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), -4.293978617723212*c2*(c1*c2 + c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 0.8822733973287209*c2*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*(1 - pow(c1,2) + pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 2.146989308861606*(c1*c2 + c3)*dc2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 2.146989308861606*c2*(c2*dc1 + c1*dc2 + dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.44113669866436045*c2*(-2*c1*dc1 + 2*c2*dc2 - 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.073494654430803*c1*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.44113669866436045*c2*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.44113669866436045*dc2*(1 - pow(c1,2) + pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.073494654430803*dc1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) + 0.44113669866436045*dc2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), -4.293978617723212*c3*(c1*c2 + c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 0.8822733973287209*c3*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*(1 - pow(c1,2) + pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 2.146989308861606*(c1*c2 + c3)*dc3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 2.146989308861606*c3*(c2*dc1 + c1*dc2 + dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.44113669866436045*c3*(-2*c1*dc1 + 2*c2*dc2 - 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.073494654430803*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.44113669866436045*c3*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.44113669866436045*dc3*(1 - pow(c1,2) + pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.44113669866436045*dc3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -(cs6*dl6) + ds6*l6*ss6, 0, 0, 0, -4.293978617723212*c1*(-c2 + c1*c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 1.7645467946574418*c1*(c1 + c2*c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 2.146989308861606*(-c2 + c1*c3)*dc1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.8822733973287209*(c1 + c2*c3)*dc1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 2.146989308861606*c1*(c3*dc1 - dc2 + c1*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.8822733973287209*c1*(dc1 + c3*dc2 + c2*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.44113669866436045*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.073494654430803*c3*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.073494654430803*dc3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), -4.293978617723212*c2*(-c2 + c1*c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 1.7645467946574418*c2*(c1 + c2*c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 2.146989308861606*(-c2 + c1*c3)*dc2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.8822733973287209*(c1 + c2*c3)*dc2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 2.146989308861606*c2*(c3*dc1 - dc2 + c1*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.8822733973287209*c2*(dc1 + c3*dc2 + c2*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.073494654430803*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.44113669866436045*c3*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.44113669866436045*dc3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), -4.293978617723212*c3*(-c2 + c1*c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 1.7645467946574418*c3*(c1 + c2*c3)*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-3) + 2.146989308861606*(-c2 + c1*c3)*dc3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.8822733973287209*(c1 + c2*c3)*dc3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 2.146989308861606*c3*(c3*dc1 - dc2 + c1*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.8822733973287209*c3*(dc1 + c3*dc2 + c2*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.073494654430803*c1*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.44113669866436045*c2*(2*c1*dc1 + 2*c2*dc2 + 2*c3*dc3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.073494654430803*dc1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) + 0.44113669866436045*dc2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 0, 0, 0, 0, 0, -(cp6*cs6*dp6*l6) - cs6*dl6*sp6 + ds6*l6*sp6*ss6, 0, 0, 0, 0, 0, -(cp6*cs6*ds6*l6) - cp6*dl6*ss6 + dp6*l6*sp6*ss6;
return dJetaqphival;
}

// dJetaqth matrix
MatrixXd dJetaqthmat(VectorXd vals, VectorXd dvals){
double p1=vals(0), p2=vals(1), p3=vals(2), p4=vals(3), p5=vals(4), p6=vals(5),s1=vals(6), s2=vals(7), s3=vals(8), s4=vals(9), s5=vals(10), \
s6=vals(11), l1=vals(12), l2=vals(13), l3=vals(14), l4=vals(15), l5=vals(16), \
l6=vals(17), x=vals(18), y=vals(19), z=vals(20), c1=vals(21), c2=vals(22), \
c3=vals(23) , dp1=dvals(0), dp2=dvals(1), dp3=dvals(2), dp4=dvals(3), dp5=dvals(4), dp6=dvals(5),ds1=dvals(6), ds2=dvals(7), ds3=dvals(8), ds4=dvals(9), ds5=dvals(10), \
ds6=dvals(11), dl1=dvals(12), dl2=dvals(13), dl3=dvals(14), dl4=dvals(15), dl5=dvals(16), \
dl6=dvals(17), dx=dvals(18), dy=dvals(19), dz=dvals(20), dc1=dvals(21), dc2=dvals(22), \
dc3=dvals(23);

double cs1=cos(s1), cs2=cos(s2), cs3=cos(s3), cs4=cos(s4), cs5=cos(s5), \
cs6=cos(s6), ss1=sin(s1), ss2=sin(s2), ss3=sin(s3), ss4=sin(s4), ss5=sin(s5), \
ss6=sin(s6), sp1=sin(p1), sp2=sin(p2), sp3=sin(p3), sp4=sin(p4), sp5=sin(p5), \
sp6=sin(p6), cp1=cos(p1), cp2=cos(p2), cp3=cos(p3), cp4=cos(p4), cp5=cos(p5), \
cp6=cos(p6);

MatrixXd dJetaqthval(passive,active);
dJetaqthval<< cp1*cs1*dp1 - ds1*sp1*ss1, 0, 0, 0, 0, 0, -(cs1*ds1), 0, 0, 0, 0, 0, -(cs1*dp1*sp1) - cp1*ds1*ss1, 0, 0, 0, 0, 0, 0, cp2*cs2*dp2 - ds2*sp2*ss2, 0, 0, 0, 0, 0, -(cs2*ds2), 0, 0, 0, 0, 0, -(cs2*dp2*sp2) - cp2*ds2*ss2, 0, 0, 0, 0, 0, 0, cp3*cs3*dp3 - ds3*sp3*ss3, 0, 0, 0, 0, 0, -(cs3*ds3), 0, 0, 0, 0, 0, -(cs3*dp3*sp3) - cp3*ds3*ss3, 0, 0, 0, 0, 0, 0, cp4*cs4*dp4 - ds4*sp4*ss4, 0, 0, 0, 0, 0, -(cs4*ds4), 0, 0, 0, 0, 0, -(cs4*dp4*sp4) - cp4*ds4*ss4, 0, 0, 0, 0, 0, 0, cp5*cs5*dp5 - ds5*sp5*ss5, 0, 0, 0, 0, 0, -(cs5*ds5), 0, 0, 0, 0, 0, -(cs5*dp5*sp5) - cp5*ds5*ss5, 0, 0, 0, 0, 0, 0, cp6*cs6*dp6 - ds6*sp6*ss6, 0, 0, 0, 0, 0, -(cs6*ds6), 0, 0, 0, 0, 0, -(cs6*dp6*sp6) - cp6*ds6*ss6;
return dJetaqthval;
}

// Jetaqth matrix
MatrixXd Jetaqthmat(VectorXd vals){
double p1=vals(0), p2=vals(1), p3=vals(2), p4=vals(3), p5=vals(4), p6=vals(5),s1=vals(6), s2=vals(7), s3=vals(8), s4=vals(9), s5=vals(10), \
s6=vals(11), l1=vals(12), l2=vals(13), l3=vals(14), l4=vals(15), l5=vals(16), \
l6=vals(17), x=vals(18), y=vals(19), z=vals(20), c1=vals(21), c2=vals(22), \
c3=vals(23);

double cs1=cos(s1), cs2=cos(s2), cs3=cos(s3), cs4=cos(s4), cs5=cos(s5), \
cs6=cos(s6), ss1=sin(s1), ss2=sin(s2), ss3=sin(s3), ss4=sin(s4), ss5=sin(s5), \
ss6=sin(s6), sp1=sin(p1), sp2=sin(p2), sp3=sin(p3), sp4=sin(p4), sp5=sin(p5), \
sp6=sin(p6), cp1=cos(p1), cp2=cos(p2), cp3=cos(p3), cp4=cos(p4), cp5=cos(p5), \
cp6=cos(p6);

MatrixXd Jetaqthmat(passive, active);
Jetaqthmat << cs1*sp1, 0, 0, 0, 0, 0, -ss1, 0, 0, 0, 0, 0, cp1*cs1, 0, 0, 0, 0, 0, 0, cs2*sp2, 0, 0, 0, 0, 0, -ss2, 0, 0, 0, 0, 0, cp2*cs2, 0, 0, 0, 0, 0, 0, cs3*sp3, 0, 0, 0, 0, 0, -ss3, 0, 0, 0, 0, 0, cp3*cs3, 0, 0, 0, 0, 0, 0, cs4*sp4, 0, 0, 0, 0, 0, -ss4, 0, 0, 0, 0, 0, cp4*cs4, 0, 0, 0, 0, 0, 0, cs5*sp5, 0, 0, 0, 0, 0, -ss5, 0, 0, 0, 0, 0, cp5*cs5, 0, 0, 0, 0, 0, 0, cs6*sp6, 0, 0, 0, 0, 0, -ss6, 0, 0, 0, 0, 0, cp6*cs6;
return Jetaqthmat;
}

// Jetaqphi matrix
MatrixXd Jetaqphimat(VectorXd vals){
double p1=vals(0), p2=vals(1), p3=vals(2), p4=vals(3), p5=vals(4), p6=vals(5),s1=vals(6), s2=vals(7), s3=vals(8), s4=vals(9), s5=vals(10), \
s6=vals(11), l1=vals(12), l2=vals(13), l3=vals(14), l4=vals(15), l5=vals(16), \
l6=vals(17), x=vals(18), y=vals(19), z=vals(20), c1=vals(21), c2=vals(22), \
c3=vals(23);
double cs1=cos(s1), cs2=cos(s2), cs3=cos(s3), cs4=cos(s4), cs5=cos(s5), \
cs6=cos(s6), ss1=sin(s1), ss2=sin(s2), ss3=sin(s3), ss4=sin(s4), ss5=sin(s5), \
ss6=sin(s6), sp1=sin(p1), sp2=sin(p2), sp3=sin(p3), sp4=sin(p4), sp5=sin(p5), \
sp6=sin(p6), cp1=cos(p1), cp2=cos(p2), cp3=cos(p3), cp4=cos(p4), cp5=cos(p5), \
cp6=cos(p6);
MatrixXd Jetaqphimat(passive, passive);
Jetaqphimat << -1, 0, 0, 0.44113669866436017*c1*(2*c1*c2 - 2*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.0734946544308033*c1*(1 + pow(c1,2) - pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.0734946544308033*c1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) - 0.44113669866436017*c2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 0.44113669866436017*c2*(2*c1*c2 - 2*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.0734946544308033*c2*(1 + pow(c1,2) - pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.44113669866436017*c1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) + 1.0734946544308033*c2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 0.44113669866436017*(2*c1*c2 - 2*c3)*c3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.0734946544308033*c3*(1 + pow(c1,2) - pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.44113669866436017*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) + 1.0734946544308033*c3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), cp1*cs1*l1, 0, 0, 0, 0, 0, -(l1*sp1*ss1), 0, 0, 0, 0, 0, 0, -1, 0, 2.1469893088616065*c1*(c1*c2 + c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.44113669866436017*c1*(1 - pow(c1,2) + pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.44113669866436017*c1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) - 1.0734946544308033*c2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 2.1469893088616065*c2*(c1*c2 + c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.44113669866436017*c2*(1 - pow(c1,2) + pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.0734946544308033*c1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) - 0.44113669866436017*c2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 2.1469893088616065*c3*(c1*c2 + c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.44113669866436017*c3*(1 - pow(c1,2) + pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.0734946544308033*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) + 0.44113669866436017*c3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 0, 0, 0, 0, 0, 0, -(cs1*l1), 0, 0, 0, 0, 0, 0, 0, -1, 2.1469893088616065*c1*(-c2 + c1*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.8822733973287203*c1*(c1 + c2*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.44113669866436017*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) - 1.0734946544308033*c3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 2.1469893088616065*c2*(-c2 + c1*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.8822733973287203*c2*(c1 + c2*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.0734946544308033*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) - 0.44113669866436017*c3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 2.1469893088616065*c3*(-c2 + c1*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.8822733973287203*c3*(c1 + c2*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.0734946544308033*c1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) - 0.44113669866436017*c2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), -(cs1*l1*sp1), 0, 0, 0, 0, 0, -(cp1*l1*ss1), 0, 0, 0, 0, 0, -1, 0, 0, 1.150241990896053*c1*(2*c1*c2 - 2*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.15471173963046458*c1*(1 + pow(c1,2) - pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.15471173963046458*c1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) - 1.150241990896053*c2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 1.150241990896053*c2*(2*c1*c2 - 2*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.15471173963046458*c2*(1 + pow(c1,2) - pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.150241990896053*c1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) - 0.15471173963046458*c2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 1.150241990896053*(2*c1*c2 - 2*c3)*c3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.15471173963046458*c3*(1 + pow(c1,2) - pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.150241990896053*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) - 0.15471173963046458*c3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 0, cp2*cs2*l2, 0, 0, 0, 0, 0, -(l2*sp2*ss2), 0, 0, 0, 0, 0, -1, 0, -0.30942347926092917*c1*(c1*c2 + c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.150241990896053*c1*(1 - pow(c1,2) + pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.150241990896053*c1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) + 0.15471173963046458*c2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), -0.30942347926092917*c2*(c1*c2 + c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.150241990896053*c2*(1 - pow(c1,2) + pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.15471173963046458*c1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) - 1.150241990896053*c2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), -0.30942347926092917*c3*(c1*c2 + c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.150241990896053*c3*(1 - pow(c1,2) + pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.15471173963046458*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) + 1.150241990896053*c3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 0, 0, 0, 0, 0, 0, 0, -(cs2*l2), 0, 0, 0, 0, 0, 0, -1, -0.30942347926092917*c1*(-c2 + c1*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 2.300483981792106*c1*(c1 + c2*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.150241990896053*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) + 0.15471173963046458*c3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), -0.30942347926092917*c2*(-c2 + c1*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 2.300483981792106*c2*(c1 + c2*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.15471173963046458*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) - 1.150241990896053*c3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), -0.30942347926092917*c3*(-c2 + c1*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 2.300483981792106*c3*(c1 + c2*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.15471173963046458*c1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) - 1.150241990896053*c2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 0, -(cs2*l2*sp2), 0, 0, 0, 0, 0, -(cp2*l2*ss2), 0, 0, 0, 0, -1, 0, 0, 0.7091052922316927*c1*(2*c1*c2 - 2*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.9187829148003384*c1*(1 + pow(c1,2) - pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.9187829148003384*c1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) - 0.7091052922316927*c2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 0.7091052922316927*c2*(2*c1*c2 - 2*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.9187829148003384*c2*(1 + pow(c1,2) - pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.7091052922316927*c1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) - 0.9187829148003384*c2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 0.7091052922316927*(2*c1*c2 - 2*c3)*c3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.9187829148003384*c3*(1 + pow(c1,2) - pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.7091052922316927*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) - 0.9187829148003384*c3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 0, 0, cp3*cs3*l3, 0, 0, 0, 0, 0, -(l3*sp3*ss3), 0, 0, 0, 0, -1, 0, -1.8375658296006767*c1*(c1*c2 + c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.7091052922316927*c1*(1 - pow(c1,2) + pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.7091052922316927*c1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) + 0.9187829148003384*c2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), -1.8375658296006767*c2*(c1*c2 + c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.7091052922316927*c2*(1 - pow(c1,2) + pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.9187829148003384*c1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) - 0.7091052922316927*c2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), -1.8375658296006767*c3*(c1*c2 + c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.7091052922316927*c3*(1 - pow(c1,2) + pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.9187829148003384*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) + 0.7091052922316927*c3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 0, 0, 0, 0, 0, 0, 0, 0, -(cs3*l3), 0, 0, 0, 0, 0, -1, -1.8375658296006767*c1*(-c2 + c1*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.4182105844633854*c1*(c1 + c2*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.7091052922316927*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) + 0.9187829148003384*c3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), -1.8375658296006767*c2*(-c2 + c1*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.4182105844633854*c2*(c1 + c2*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.9187829148003384*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) - 0.7091052922316927*c3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), -1.8375658296006767*c3*(-c2 + c1*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.4182105844633854*c3*(c1 + c2*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.9187829148003384*c1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) - 0.7091052922316927*c2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 0, 0, -(cs3*l3*sp3), 0, 0, 0, 0, 0, -(cp3*l3*ss3), 0, 0, 0, -1, 0, 0, -0.7091052922316927*c1*(2*c1*c2 - 2*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.9187829148003388*c1*(1 + pow(c1,2) - pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.9187829148003388*c1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) + 0.7091052922316927*c2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), -0.7091052922316927*c2*(2*c1*c2 - 2*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.9187829148003388*c2*(1 + pow(c1,2) - pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.7091052922316927*c1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) - 0.9187829148003388*c2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), -0.7091052922316927*(2*c1*c2 - 2*c3)*c3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.9187829148003388*c3*(1 + pow(c1,2) - pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.7091052922316927*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) - 0.9187829148003388*c3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 0, 0, 0, cp4*cs4*l4, 0, 0, 0, 0, 0, -(l4*sp4*ss4), 0, 0, 0, -1, 0, -1.8375658296006776*c1*(c1*c2 + c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.7091052922316927*c1*(1 - pow(c1,2) + pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.7091052922316927*c1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) + 0.9187829148003388*c2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), -1.8375658296006776*c2*(c1*c2 + c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.7091052922316927*c2*(1 - pow(c1,2) + pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.9187829148003388*c1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) + 0.7091052922316927*c2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), -1.8375658296006776*c3*(c1*c2 + c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.7091052922316927*c3*(1 - pow(c1,2) + pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.9187829148003388*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) - 0.7091052922316927*c3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 0, 0, 0, 0, 0, 0, 0, 0, 0, -(cs4*l4), 0, 0, 0, 0, -1, -1.8375658296006776*c1*(-c2 + c1*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.4182105844633854*c1*(c1 + c2*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.7091052922316927*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) + 0.9187829148003388*c3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), -1.8375658296006776*c2*(-c2 + c1*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.4182105844633854*c2*(c1 + c2*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.9187829148003388*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) + 0.7091052922316927*c3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), -1.8375658296006776*c3*(-c2 + c1*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.4182105844633854*c3*(c1 + c2*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.9187829148003388*c1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) + 0.7091052922316927*c2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 0, 0, 0, -(cs4*l4*sp4), 0, 0, 0, 0, 0, -(cp4*l4*ss4), 0, 0, -1, 0, 0, -1.1502419908960528*c1*(2*c1*c2 - 2*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.15471173963046492*c1*(1 + pow(c1,2) - pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.15471173963046492*c1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) + 1.1502419908960528*c2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), -1.1502419908960528*c2*(2*c1*c2 - 2*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.15471173963046492*c2*(1 + pow(c1,2) - pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.1502419908960528*c1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) - 0.15471173963046492*c2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), -1.1502419908960528*(2*c1*c2 - 2*c3)*c3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.15471173963046492*c3*(1 + pow(c1,2) - pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.1502419908960528*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) - 0.15471173963046492*c3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 0, 0, 0, 0, cp5*cs5*l5, 0, 0, 0, 0, 0, -(l5*sp5*ss5), 0, 0, -1, 0, -0.30942347926092983*c1*(c1*c2 + c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.1502419908960528*c1*(1 - pow(c1,2) + pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.1502419908960528*c1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) + 0.15471173963046492*c2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), -0.30942347926092983*c2*(c1*c2 + c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.1502419908960528*c2*(1 - pow(c1,2) + pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.15471173963046492*c1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) + 1.1502419908960528*c2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), -0.30942347926092983*c3*(c1*c2 + c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.1502419908960528*c3*(1 - pow(c1,2) + pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.15471173963046492*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) - 1.1502419908960528*c3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -(cs5*l5), 0, 0, 0, -1, -0.30942347926092983*c1*(-c2 + c1*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 2.3004839817921057*c1*(c1 + c2*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.1502419908960528*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) + 0.15471173963046492*c3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), -0.30942347926092983*c2*(-c2 + c1*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 2.3004839817921057*c2*(c1 + c2*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.15471173963046492*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) + 1.1502419908960528*c3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), -0.30942347926092983*c3*(-c2 + c1*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 2.3004839817921057*c3*(c1 + c2*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.15471173963046492*c1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) + 1.1502419908960528*c2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 0, 0, 0, 0, -(cs5*l5*sp5), 0, 0, 0, 0, 0, -(cp5*l5*ss5), 0, -1, 0, 0, -0.44113669866436045*c1*(2*c1*c2 - 2*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.073494654430803*c1*(1 + pow(c1,2) - pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.073494654430803*c1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) + 0.44113669866436045*c2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), -0.44113669866436045*c2*(2*c1*c2 - 2*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.073494654430803*c2*(1 + pow(c1,2) - pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.44113669866436045*c1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) + 1.073494654430803*c2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), -0.44113669866436045*(2*c1*c2 - 2*c3)*c3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.073494654430803*c3*(1 + pow(c1,2) - pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.44113669866436045*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) + 1.073494654430803*c3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 0, 0, 0, 0, 0, cp6*cs6*l6, 0, 0, 0, 0, 0, -(l6*sp6*ss6), 0, -1, 0, 2.146989308861606*c1*(c1*c2 + c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.44113669866436045*c1*(1 - pow(c1,2) + pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.44113669866436045*c1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) - 1.073494654430803*c2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 2.146989308861606*c2*(c1*c2 + c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.44113669866436045*c2*(1 - pow(c1,2) + pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.073494654430803*c1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) + 0.44113669866436045*c2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 2.146989308861606*c3*(c1*c2 + c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.44113669866436045*c3*(1 - pow(c1,2) + pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.073494654430803*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) - 0.44113669866436045*c3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -(cs6*l6), 0, 0, -1, 2.146989308861606*c1*(-c2 + c1*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.8822733973287209*c1*(c1 + c2*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 0.44113669866436045*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) - 1.073494654430803*c3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 2.146989308861606*c2*(-c2 + c1*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.8822733973287209*c2*(c1 + c2*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) + 1.073494654430803*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) + 0.44113669866436045*c3*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 2.146989308861606*c3*(-c2 + c1*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 0.8822733973287209*c3*(c1 + c2*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-2) - 1.073494654430803*c1*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) + 0.44113669866436045*c2*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 0, 0, 0, 0, 0, -(cs6*l6*sp6), 0, 0, 0, 0, 0, -(cp6*l6*ss6);
return Jetaqphimat;
}

// Loop-closure equations
VectorXd etavec(VectorXd vals){
double p1=vals(0), p2=vals(1), p3=vals(2), p4=vals(3), p5=vals(4), p6=vals(5),s1=vals(6), s2=vals(7), s3=vals(8), s4=vals(9), s5=vals(10), \
s6=vals(11), l1=vals(12), l2=vals(13), l3=vals(14), l4=vals(15), l5=vals(16), \
l6=vals(17), x=vals(18), y=vals(19), z=vals(20), c1=vals(21), c2=vals(22), \
c3=vals(23);
double cs1=cos(s1), cs2=cos(s2), cs3=cos(s3), cs4=cos(s4), cs5=cos(s5), \
cs6=cos(s6), ss1=sin(s1), ss2=sin(s2), ss3=sin(s3), ss4=sin(s4), ss5=sin(s5), \
ss6=sin(s6), sp1=sin(p1), sp2=sin(p2), sp3=sin(p3), sp4=sin(p4), sp5=sin(p5), \
sp6=sin(p6), cp1=cos(p1), cp2=cos(p2), cp3=cos(p3), cp4=cos(p4), cp5=cos(p5), \
cp6=cos(p6);
VectorXd etaval(passive);
etaval << 0.7325760476016683 + cs1*l1*sp1 - x - 0.22056834933218009*(2*c1*c2 - 2*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) - 0.5367473272154016*(1 + pow(c1,2) - pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 0.6806851948443702 - l1*ss1 - y - 1.0734946544308033*(c1*c2 + c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) - 0.22056834933218009*(1 - pow(c1,2) + pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), cp1*cs1*l1 - z - 1.0734946544308033*(-c2 + c1*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) - 0.44113669866436017*(c1 + c2*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 0.22320264691435115 + cs2*l2*sp2 - x - 0.5751209954480265*(2*c1*c2 - 2*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) + 0.07735586981523229*(1 + pow(c1,2) - pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 0.974772064849228 - l2*ss2 - y + 0.15471173963046458*(c1*c2 + c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) - 0.5751209954480265*(1 - pow(c1,2) + pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), cp2*cs2*l2 - z + 0.15471173963046458*(-c2 + c1*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) - 1.150241990896053*(c1 + c2*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), -0.955778694516019 + cs3*l3*sp3 - x - 0.35455264611584636*(2*c1*c2 - 2*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) + 0.4593914574001692*(1 + pow(c1,2) - pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 0.2940868700048578 - l3*ss3 - y + 0.9187829148003384*(c1*c2 + c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) - 0.35455264611584636*(1 - pow(c1,2) + pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), cp3*cs3*l3 - z + 0.9187829148003384*(-c2 + c1*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) - 0.7091052922316927*(c1 + c2*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), -0.9557786945160192 + cs4*l4*sp4 - x + 0.35455264611584636*(2*c1*c2 - 2*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) + 0.4593914574001694*(1 + pow(c1,2) - pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), -0.2940868700048576 - l4*ss4 - y + 0.9187829148003388*(c1*c2 + c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) + 0.35455264611584636*(1 - pow(c1,2) + pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), cp4*cs4*l4 - z + 0.9187829148003388*(-c2 + c1*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) + 0.7091052922316927*(c1 + c2*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 0.22320264691435077 + cs5*l5*sp5 - x + 0.5751209954480264*(2*c1*c2 - 2*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) + 0.07735586981523246*(1 + pow(c1,2) - pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), -0.974772064849228 - l5*ss5 - y + 0.15471173963046492*(c1*c2 + c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) + 0.5751209954480264*(1 - pow(c1,2) + pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), cp5*cs5*l5 - z + 0.15471173963046492*(-c2 + c1*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) + 1.1502419908960528*(c1 + c2*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), 0.7325760476016681 + cs6*l6*sp6 - x + 0.22056834933218022*(2*c1*c2 - 2*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) - 0.5367473272154015*(1 + pow(c1,2) - pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), -0.6806851948443704 - l6*ss6 - y - 1.073494654430803*(c1*c2 + c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) + 0.22056834933218022*(1 - pow(c1,2) + pow(c2,2) - pow(c3,2))*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1), cp6*cs6*l6 - z - 1.073494654430803*(-c2 + c1*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1) + 0.44113669866436045*(c1 + c2*c3)*pow(1 + pow(c1,2) + pow(c2,2) + pow(c3,2),-1);
return etaval;
}
