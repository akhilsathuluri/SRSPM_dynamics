#include<iostream>
#include<Eigen/Dense>
#include"dyn_funcs_test.h"

using namespace Eigen;
int main(int argc, char const *argv[]) {
  //Testing matrices at this configuration
VectorXd q(18);
q << -0.1761803387559435, -0.26672457929093996, 0.42390218334416085, \
0.42390218334416074, -0.2667245792909397, -0.1761803387559434, \
0.3906484106163457, 0.3370952157706408, -0.05006177387374231, \
0.05006177387374249, -0.3370952157706409, -0.3906484106163457, \
1.2083279353106968, 1.2083279353106968, 1.2083279353106968, \
1.2083279353106968, 1.2083279353106968, 1.2083279353106968;

VectorXd dq(18);
dq << 0.06624059529735823, 0.08303839919975621, 0.07035174383427208, \
0.008916220242014062, -0.003770435123470023, 0.03025924388757711, \
0.108351678995563, 0.08633350197949015, 0.05029075837340629, \
0.050290758373406276, 0.08633350197949018, 0.14243291434227942, 0.1, \
0, 0, 0, 0, 0;

VectorXd etatest(12);
etatest = etavec(q);
std::cout << etatest << std::endl;

MatrixXd Mtest(18,18);
Mtest << 18.822422207754474, 0.007168695181435066, 0.006286972033147634, \
0.006286972033147634, 0.15414729080364875, -14.965590813076533, \
0.3559318952438274, 0.00022810947372223648, 0.0002155413709610267, \
-0.00021554137096102744, 0.18829779045544584, 0.13440937479495885, \
-0.7152896594047535, -0.000538648213355469, 0.003560217834687441, \
0.0035602178346874403, 0.44463856214544084, 0.270112449045945, \
0.007168695181435066, 4.109762146853732, 0.0059932625553359, \
0.005993262555335901, 0.007346533929895701, 0.007168695181435066, \
-0.00026803418297542344, 0., 0.00024815200878244473, \
-0.0002481520087824456, 6.174444636131149e-19, 0.0002680341829754236, \
0.000538648213355469, 0., 0.0040988660480429095, \
0.004098866048042909, 1.2348889272262297e-18, 0.0005386482133554693, \
0.006286972033147634, 0.0059932625553359, 4.602753949445429, \
0.008228257078183135, 0.0059932625553359015, 0.006286972033147634, \
0.0017715831128269908, 0.0017358085553696708, 0., \
4.4103175972365347e-20, -0.0017358085553696708, \
-0.0017715831128269903, -0.003560217834687441, \
-0.0040988660480429095, 0., -7.056508155578455e-19, \
-0.004098866048042909, -0.0035602178346874403, 0.006286972033147634, \
0.005993262555335901, 0.008228257078183135, 4.602753949445429, \
0.005993262555335902, 0.006286972033147634, 0.0017715831128269908, \
0.00173580855536967, 2.2051587986182673e-20, 0., \
-0.0017358085553696705, -0.0017715831128269903, \
-0.0035602178346874403, -0.004098866048042909, 7.056508155578455e-19, \
0., -0.004098866048042908, -0.0035602178346874403, \
0.15414729080364875, 0.007346533929895701, 0.0059932625553359015, \
0.005993262555335902, 4.390434220869319, -0.32268162106509896, \
-0.34026147353646047, 7.056508155578455e-19, 0.0002481520087824447, \
-0.00024815200878244555, 0.3600113003853982, -0.7627474444840548, \
0.683797987105697, -1.2348889272262297e-18, 0.004098866048042909, \
0.004098866048042908, 0.8501156947847989, -1.5328363854637883, \
-14.965590813076533, 0.007168695181435066, 0.006286972033147634, \
0.006286972033147634, -0.32268162106509896, 19.13309979783071, \
-0.1344093747949301, 0.00022810947372223667, 0.0002155413709610267, \
-0.00021554137096102741, -0.42331915513955076, 0.36273290035379857, \
0.2701124490459521, -0.0005386482133554693, 0.0035602178346874403, \
0.0035602178346874403, -0.9996082270248907, 0.7289571297655975, \
0.3559318952438274, -0.00026803418297542344, 0.0017715831128269908, \
0.0017715831128269908, -0.34026147353646047, -0.1344093747949301, \
6.340020297681735, 0.008232831496697785, 0.0074881822426480765, \
0.007747624623946553, -0.4299378539351688, 2.244003573765745, \
-3.4680443402718337, -0.0003553685548287595, -0.002458556113659943, \
-0.001826799355938634, -1.034322643722785, 4.493028613397094, \
0.00022810947372223648, 0., 0.0017358085553696708, \
0.00173580855536967, 7.056508155578455e-19, 0.00022810947372223667, \
0.008232831496697785, 4.614303200289523, 0.007669665206215922, \
0.00788014762979942, 0.0064441547752384235, 0.006163531118745459, \
0.00037397015514526187, -1.9319672573816383e-17, \
-0.0020607167294232082, -0.0014159396312051107, \
-0.004261681126117818, -0.004532488069190654, 0.0002155413709610267, \
0.00024815200878244473, 0., 2.2051587986182673e-20, \
0.0002481520087824447, 0.0002155413709610267, 0.0074881822426480765, \
0.007669665206215922, 4.614303200289523, 0.00820760107181329, \
0.00788014762979942, 0.007747624623946553, 0.0028569665542480666, \
0.0025036009591098756, 9.880352166770018e-18, 0.0006823737080584639, \
-0.0020065765280069627, -0.002335584640927235, \
-0.00021554137096102744, -0.0002481520087824456, \
4.4103175972365347e-20, 0., -0.00024815200878244555, \
-0.00021554137096102741, 0.007747624623946553, 0.00788014762979942, \
0.00820760107181329, 4.614303200289523, 0.007669665206215922, \
0.0074881822426480765, 0.0023355846409272335, 0.0020065765280069606, \
-0.0006823737080584639, -2.2051587986182673e-20, \
-0.0025036009591098774, -0.002856966554248068, 0.18829779045544584, \
6.174444636131149e-19, -0.0017358085553696708, \
-0.0017358085553696705, 0.3600113003853982, -0.42331915513955076, \
-0.4299378539351688, 0.0064441547752384235, 0.00788014762979942, \
0.007669665206215922, 5.076081012919318, -0.9704687213833006, \
0.8809327639350362, 0.004261681126117818, 0.0014159396312051124, \
0.00206071672942321, 1.090422899502698, -1.9671971455236927, \
0.13440937479495885, 0.0002680341829754236, -0.0017715831128269903, \
-0.0017715831128269903, -0.7627474444840548, 0.36273290035379857, \
2.244003573765745, 0.006163531118745459, 0.007747624623946553, \
0.0074881822426480765, -0.9704687213833006, 8.00244818089235, \
-4.493028613397093, 0.004530991197318456, 0.0018267993559386356, \
0.0024585561136599445, -2.310709727798706, 6.808901089150849, \
-0.7152896594047535, 0.000538648213355469, -0.003560217834687441, \
-0.0035602178346874403, 0.683797987105697, 0.2701124490459521, \
-3.4680443402718337, 0.00037397015514526187, 0.0028569665542480666, \
0.0023355846409272335, 0.8809327639350362, -4.493028613397093, \
18.31554155368888, 0.005621427416103191, 0.004198323636125498, \
0.004413634143543283, 2.0736934440106887, -9.034952657748395, \
-0.000538648213355469, 0., -0.0040988660480429095, \
-0.004098866048042909, -1.2348889272262297e-18, \
-0.0005386482133554693, -0.0003553685548287595, \
-1.9319672573816383e-17, 0.0025036009591098756, \
0.0020065765280069606, 0.004261681126117818, 0.004530991197318456, \
0.005621427416103191, 11.34607270838023, 0.0040113079348267425, \
0.004198323636125497, 0.004413634143543281, 0.004198323636125498, \
0.003560217834687441, 0.0040988660480429095, 0., \
7.056508155578455e-19, 0.004098866048042909, 0.0035602178346874403, \
-0.002458556113659943, -0.0020607167294232082, 9.880352166770018e-18, \
-0.0006823737080584639, 0.0014159396312051124, 0.0018267993559386356, \
0.004198323636125498, 0.0040113079348267425, 11.346072708380232, \
0.005621427416103191, 0.004198323636125497, 0.004413634143543281, \
0.0035602178346874403, 0.004098866048042909, -7.056508155578455e-19, \
0., 0.004098866048042908, 0.0035602178346874403, \
-0.001826799355938634, -0.0014159396312051107, 0.0006823737080584639, \
-2.2051587986182673e-20, 0.00206071672942321, 0.0024585561136599445, \
0.004413634143543283, 0.004198323636125497, 0.005621427416103191, \
11.346072708380232, 0.004011307934826743, 0.004198323636125496, \
0.44463856214544084, 1.2348889272262297e-18, -0.004098866048042909, \
-0.004098866048042908, 0.8501156947847989, -0.9996082270248907, \
-1.034322643722785, -0.004261681126117818, -0.0020065765280069627, \
-0.0025036009591098774, 1.090422899502698, -2.310709727798706, \
2.0736934440106887, 0.004413634143543281, 0.004198323636125497, \
0.004011307934826743, 13.92095194085887, -4.638752925437109, \
0.270112449045945, 0.0005386482133554693, -0.0035602178346874403, \
-0.0035602178346874403, -1.5328363854637883, 0.7289571297655975, \
4.493028613397094, -0.004532488069190654, -0.002335584640927235, \
-0.002856966554248068, -1.9671971455236927, 6.808901089150849, \
-9.034952657748395, 0.004198323636125498, 0.004413634143543281, \
0.004198323636125496, -4.638752925437109, 25.029411026916687;

MatrixXd Mval(18,18);
Mval = Mmat(q);
std::cout<<"Max val mmat: "<<(Mval-Mtest).maxCoeff()<<std::endl;
std::cout<<"Max val mmat: "<<(Mval-Mtest).minCoeff()<<std::endl;

MatrixXd Ctest(18,18);
Ctest << 1.741901925816301, -0.00016285991559296294, -0.00028680531992675143, \
-0.00005419838016107128, 0.05568347847935751, -1.8062065691006364, \
-1.593400760945519, -0.00015243654871479104, -0.0001941855388747583, \
-0.0002191549606709502, -0.1550577178882785, 1.043299235949083, \
0.7864225849670805, 0.0005089433455499694, 0.0003750134145985736, \
0.00003742054369108585, -0.19113605085274304, -0.61289196750217, \
0.00023028861482965864, -0.12428610690298626, \
-0.00033333478948945717, -0.000059261549680809646, \
0.00022228754492627996, 0.00040079046487357083, \
-0.00028825741238063386, -0.11954246177162543, \
-0.00022795325726443247, -0.00025175617858975324, \
-9.707943587173037e-6, -3.3742063413401988e-6, \
0.00036895338553547436, 0.38489330057015986, 0.000359270204761471, \
0.00003389601034714648, -0.00002292393377292941, \
0.00021111502781708934, 0.0005247358692073595, \
0.00022992947937722832, 0.011592383643718623, \
-0.00002073315002148375, 0.0001626668597930389, \
0.0004989395496661372, 0.0004412329723136136, 0.0002531706460884697, \
0.01621658592769914, -3.6758509491879237e-6, 0.0004196706663059409, \
0.0006910765915151668, 0.0005035113043977528, 0.0005358887608300292, \
0.36522593852695634, 0.000060716093845937314, \
-0.00014272254572141144, -0.00005138731289710592, \
0.0005247358692073594, 0.00022992947937722826, \
0.000020733150021483642, -0.011592383643718661, \
0.00016266685979303893, 0.0004989395496661372, 0.0004412329723136135, \
0.00025317064608846966, 0.000029003604367204475, \
-0.0020552532719803622, 0.0004196706663059409, 0.0006910765915151667, \
0.0005035113043977528, 0.0005358887608300292, 0.00047906881670995273, \
0.046287906006620534, -0.00014272254572141147, \
-0.000051387312897105864, 0.9068156570187217, \
-0.00022228754492627963, -0.00033333478948945706, \
-0.000059261549680809646, 0.05172269522147049, -0.8928082190527051, \
0.7495733073629602, -0.0002138034652770975, -0.00022795325726443236, \
-0.0002517561785897532, -0.3579588970350626, 0.5285134990444185, \
-0.7136987063793385, 0.0005048666006785423, 0.000359270204761471, \
0.00003389601034714649, -0.5154411815193876, 1.415427912730257, \
-2.381279685848434, -0.0001628599155929629, -0.00028680531992675143, \
-0.00005419838016107127, 0.05121112656210908, 2.899315837222714, \
0.8725202319337164, -0.000152436548714791, -0.00019418553887475825, \
-0.00021915496067095017, 0.4607602951937559, -1.5521775553288284, \
0.22426228967012862, 0.0005089433455499694, 0.00037501341459857357, \
0.00003742054369108584, 0.6947764909055438, -0.6039256496566425, \
4.61182365439995, 0.0002532528845783826, 0.0001866086467837567, \
0.000018620659283830675, -0.6943309314381385, -3.8540255895820614, \
1.3211527603487387, 0.00004487225691039717, 0.00015564548452763095, \
0.00011021901849882554, -0.3667309647002256, 1.5368410849712806, \
-1.478687808156379, 0.0005698056170942009, 0.0004148048807850282, \
0.0003355295622106916, -1.2718416258631897, 3.2238065485516403, \
0.00017512435825460575, 0.11954246177162543, 0.00015214556606750717, \
0.00001435445414996391, -9.707943587172834e-6, \
0.00008940406130787845, 0.0006261564794253896, \
-7.864402354510157e-18, 0.00013134358798762744, \
0.00008526798815454252, 0.0004445750898525598, 0.0007829093997486797, \
0.0007507491934743951, 0.4493192033206573, 0.00042027534387248356, \
0.00034078120660909926, 0.00046042670436244966, \
0.0007322450257290187, -0.000012645406025968559, \
-0.00003244357608304907, -0.01621658592769914, -3.675850949187947e-6, \
8.640654757728203e-6, 3.1110713967921746e-6, 0.0002397881851701314, \
-0.0002683954809130293, -6.24650123831502e-19, \
-0.00004146630004296745, 0.0002089965064566732, \
0.00040465325177648344, 0.000683286948196767, 0.0005650413119471665, \
0.26173620864005676, 0.00034160137348950557, 0.0005622522496522435, \
0.0009186569646302704, 0.00001264540602596861, \
0.000032443576083049185, 0.000029003604367204607, \
0.0020552532719803622, -8.640654757728233e-6, -3.1110713967921797e-6, \
0.0003412803641126859, -0.00020210254609738624, \
0.00004146630004296746, 9.939909531794068e-19, 0.0002615015205537428, \
0.0004890142470825788, 0.0006829193660048325, 0.0005459731387066147, \
0.0003416013734895057, 0.26173620864005676, 0.0005487622010015381, \
0.0008772796440910975, -0.09524278039573947, -0.0002138034652770978, \
-0.00015214556606750728, -0.000014354454149963924, \
0.14649089005158467, -0.040416878372173226, 0.4690627597947383, \
-0.0004445750898525597, -0.00009216194851382937, \
-0.00012444962762834082, -0.15185942103529237, -0.16759958451370693, \
0.07474395158681191, 0.00046042670436244955, 0.0002269097929063501, \
0.00030640393016973417, 0.5197633379237017, 0.11693655774398537, \
-3.6321981807907515, -0.00025325288457838253, -0.0001866086467837567, \
-0.00001862065928383068, -0.13285808305075375, 3.9183002387396844, \
-1.709779820952242, -0.0004804697961299277, -0.00011725506156661087, \
-0.00014860944145984577, 0.7439420345228269, -1.3220695934117328, \
1.807772978308495, 0.000458796274856798, 0.00021931128864274976, \
0.0002985866072170861, 0.8480760260213001, -2.31145101249571, \
0.30449582151103993, -0.0005089433455499694, -0.0003750134145985736, \
-0.00003742054369108585, 0.548568104482897, -1.3542501115844647, \
0.11285861021984989, -0.0006020987909489829, -0.0002676719241360636, \
-0.00026661604600307186, -0.3486364418560428, 0.4746300597003321, \
-0.4889243092968514, 0.00006373653728244545, -0.00008837709972507296, \
0.0000709365678050396, -0.0076323714549462185, 0.6818615293938599, \
-0.00041353136785423673, -0.38489330057015986, -0.000359270204761471, \
-0.00003389601034714648, 0.00002292393377292941, \
-0.00021111502781708934, -0.0007506980860010124, -0.4493192033206573, \
-0.00025820607419353275, -0.0002532914825592721, \
-0.00046042670436244966, -0.0007292674769747843, \
-0.00006139488769443402, 3.056731400021023e-17, \
-0.00013444560750233345, 0.0000532685382998547, \
0.0003044917237993376, 0.0005206063478736011, \
-0.00020887127079031954, -0.0005358887608300292, \
-0.36522593852695634, -0.000060716093845937314, \
0.00014272254572141144, 0.00005138731289710592, \
-0.0008502487304402697, -0.0005377441489541845, -0.2617362086400568, \
-0.00034160137348950557, -0.0004433820602685495, \
-0.0007152470404564098, -0.000025289272199136936, \
0.00013444560750233372, 9.896220903645234e-19, \
-0.000028400478272075646, 0.00008837709972507332, \
0.0003044917237993369, -0.00020887127079031965, \
-0.0005358887608300292, -0.00047906881670995273, \
-0.046287906006620534, 0.00014272254572141147, \
0.000051387312897105864, -0.0008261545694993345, \
-0.0005572534739712986, -0.0003416013734895057, -0.26173620864005676, \
-0.0004238727352514355, -0.0006781908814683363, \
0.0000313608336335118, 0.0001805141152795943, 0.00002840047827207561, \
-9.885130992813599e-19, 0.0001344456075023339, \
0.00037896070984867313, -0.22490233596190845, -0.0005048666006785423, \
-0.000359270204761471, -0.00003389601034714649, 0.35057662216037766, \
-0.09543873373311218, 1.1068973886585614, -0.00046042670436244955, \
-0.0002695705935049007, -0.00024192696324790427, -0.8079137171174016, \
-0.3968821426359823, 0.1747858621325462, -0.0003044917237993374, \
-0.00032215975330452204, -0.00013444560750233386, \
0.16634384633891375, 0.27387941925609827, 2.3517569084931904, \
-0.0005089433455499694, -0.00037501341459857357, \
-0.00003742054369108584, -1.113771675524076, -1.2609786877251477, \
-1.150757591898187, -0.00045364176844306923, -0.00028075585453600873, \
-0.0002535321156031267, 0.4083925354646556, 0.16398156829688926, \
-0.9623245065615675, -0.0002868236942941525, -0.0003044917237993372, \
-0.0001451780562692246, -0.8616600084968202, 1.0236924658291553;

MatrixXd Cval(18,18);
Cval = Cmat(q, dq);
std::cout<<"Max val Cmat: "<<(Cval-Ctest).maxCoeff()<<std::endl;
std::cout<<"Max val Cmat: "<<(Cval-Ctest).minCoeff()<<std::endl;

MatrixXd Jetaqtest(12, 18);
Jetaqtest<< 1.3510270334673953, -1.3510270334673953, 0, 0, 0, 0, \
0.8913285378356105, -0.93798471206999, 0, 0, 0, 0, \
0.07096848560101204, 0.07096848560101221, 0, 0, 0, 0, 0, \
0.8404782926868604, -0.8404782926868604, 0, 0, 0, 0, \
-0.42255288612904196, 0.5133669251491064, 0, 0, 0, 0, \
-0.3359591718400785, -0.3359591718400783, 0, 0, 0, 0, 0, \
4.440892098500626e-16, -4.440892098500626e-16, 0, 0, 0, 0, \
-1.711516540213569, 1.7115165402135692, 0, 0, 0, 0, \
0.07096848560101171, 0.07096848560101192, 0, 0, 0, 0, 0, \
-0.840478292686861, 0.8404782926868615, 0, 0, 0, 0, \
-0.5133669251491055, 0.42255288612904107, 0, 0, 0, 0, \
-0.33595917184007895, -0.33595917184007895, 0, 0, 0, 0, 0, \
-1.3510270334673948, 1.3510270334673948, 0, 0, 0, 0, \
0.9379847120699893, -0.8913285378356101, 0, 0, 0, 0, \
0.07096848560101154, 0.07096848560101168, -2.220446049250313e-16, 0, \
0, 0, 0, 2.220446049250313e-16, -0.9857599597616888, 0, 0, 0, 0, \
0.9857599597616893, -0.33595917184007884, 0, 0, 0, 0, \
-0.33595917184007884, 2.191505326154256, 0, -2.191505326154255, 0, 0, \
0, 0.46006694794035097, 0, -0.37293782791973373, 0, 0, 0, \
-0.2208409615222895, 0, -0.8050283377127992, 0, 0, 0, \
2.191505326154256, 0, 0, -2.191505326154256, 0, 0, -1.124493136164, \
0, 0, 1.4376778101628354, 0, 0, -0.7608786129960214, 0, 0, \
-0.7608786129960211, 0, 0, 1.3510270334673946, 0, 0, 0, \
-1.3510270334673948, 0, -1.67899150603043, 0, 0, 0, \
1.9440609251480527, 0, -0.8050283377127992, 0, 0, 0, \
-0.2208409615222895, 0, -0.053050677328085584, 0.2123047031357713, \
0.3506317044779759, -0.13447301853410631, 0, 0, 0.12271774790370182, \
-0.27231812257032634, -0.03893072708660447, -0.0149305733571852, 0, \
0, -0.24661666255231662, 0.6430406760108311, -0.6430406760108314, \
0.24661666255231643, 0, 0, -0.05305067732808527, 0, \
-0.21812911884168168, 0.43428780478555107, 0.21230470313577138, 0, \
0.12271774790370246, 0, 0.024218931393868333, 0.04821908512328758, \
0.2723181225703261, 0, -0.2466166625523168, 0, 0.40003768696966746, \
-0.7964617004281822, 0.643040676010831, 0, -0.05305067732808501, 0, \
0, -0.1344730185341056, -0.132075443348447, 0.0860536754932332, \
0.12271774790370202, 0, 0, -0.014930573357185024, \
-0.1694099859261799, 0.19906085628382747, -0.2466166625523165, 0, 0, \
0.24661666255231662, -0.40003768696966824, 0.4000376869696678;

VectorXd Gtest(18);
Gtest << 8.779645807467926, 13.475027136462483, -22.2546729439304, \
-22.254672943930395, 13.475027136462472, 8.779645807467922, \
-20.309229121081408, -17.284092331383654, 2.4709419819057565, \
-2.470941981905765, 17.28409233138366, 20.309229121081408, \
101.4750882115365, 101.47508821153649, 101.47508821153649, \
101.47508821153649, 101.47508821153649, 101.4750882115365;

VectorXd Gval(18);
Gval = Gvec(q);
std::cout<<"Max val Gmat: "<<(Gval-Gtest).maxCoeff()<<std::endl;
std::cout<<"Max val Gmat: "<<(Gval-Gtest).minCoeff()<<std::endl;

MatrixXd dJetaqtest(12, 18);
dJetaqtest << 0.015141389196768051, 0.04929365140987649, 0, 0, 0, 0, \
0.10028568945978583, -0.05035116698577485, 0, 0, 0, 0, \
0.32672631087805465, -0.33259959109670345, 0, 0, 0, 0, 0, \
0.055917390326218175, 0.000260272910533349, 0, 0, 0, 0, \
0.08291859517735714, -0.07738756086080593, 0, 0, 0, 0, \
0.0850770661481002, -0.08507706614810032, 0, 0, 0, 0, 0, \
0.17894942865033509, -0.17894942865033509, 0, 0, 0, 0, \
-0.0035771194513146694, -0.0035771194513147544, 0, 0, 0, 0, \
-0.05908529026513744, 0.05908529026513746, 0, 0, 0, 0, 0, \
0.09251991294194428, 0.00026027291053360227, 0, 0, 0, 0, \
-0.06708615329173043, 0.15497632897723873, 0, 0, 0, 0, \
-0.08507706614810048, 0.08507706614810044, 0, 0, 0, 0, 0, \
-0.1395964496740029, 0.17861135332597505, 0, 0, 0, 0, \
-0.1661803884910918, 0.16928712749666372, 0, 0, 0, 0, \
0.059085290265137466, -0.05908529026513744, 0.08983456002270997, 0, \
0, 0, 0, -0.08983456002270997, -0.016499839404410854, 0, 0, 0, 0, \
0.07891589802284982, -0.1307877251021253, 0, 0, 0, 0, \
0.1585913669796668, 0.11439545647267158, 0, 0.17962807731342462, 0, \
0, 0, 0.14617390223354745, 0, -0.20536133360677708, 0, 0, 0, \
0.39919608184385763, 0, -0.2809195068290207, 0, 0, 0, \
0.2588000415599738, 0, 0, -0.049033378499343264, 0, 0, \
0.1196512314195672, 0, 0, -0.18072626356114024, 0, 0, \
0.18896132171245472, 0, 0, -0.12599177588296284, 0, 0, \
0.24938053430678003, 0, 0, 0, -0.2261795801748971, 0, \
0.057263179241394624, 0, 0, 0, -0.114585417352836, 0, \
-0.014296174355473645, 0, 0, 0, 0.1809195068290213, 0, \
0.042353705553401996, -0.13518650809063848, 0.11978862655581947, \
-0.02695582401858284, 0, 0, 0.056348385644213454, \
-0.10775582189095995, 0.07176113272433236, -0.025873391016784417, 0, \
0, 0.008095952509998549, 0.001438822923326484, 0.04154208789708978, \
-0.01129187779069648, 0, 0, 0.04235370555340203, 0, \
-0.0745208925039387, 0.08705527522792164, -0.05488808827738463, 0, \
0.05634838564421352, 0, -0.044642833059104325, 0.08355949996160474, \
-0.0895540480722517, 0, 0.008095952509998505, 0, \
-0.025843467410703064, 0.0364677231989442, 0.04154208789709001, 0, \
0.042353705553401816, 0, 0, -0.026955824018582736, \
0.03414605746698068, -0.04954393900179967, 0.056348385644213544, 0, \
0, -0.02587339101678446, 0.05571186331763353, -0.08212320755548316, \
0.008095952509998387, 0, 0, -0.011291877790696535, \
-0.025843467410703175, 0.03739573944350131;

MatrixXd Jetaphtest(12, 12);
Jetaphtest << 1.3510270334673953, -1.3510270334673953, 0, 0, 0, 0, \
0.8913285378356105, -0.93798471206999, 0, 0, 0, 0, 0, \
0.8404782926868604, -0.8404782926868604, 0, 0, 0, 0, \
-0.42255288612904196, 0.5133669251491064, 0, 0, 0, 0, 0, \
4.440892098500626e-16, -4.440892098500626e-16, 0, 0, 0, 0, \
-1.711516540213569, 1.7115165402135692, 0, 0, 0, 0, 0, \
-0.840478292686861, 0.8404782926868615, 0, 0, 0, 0, \
-0.5133669251491055, 0.42255288612904107, 0, 0, 0, 0, 0, \
-1.3510270334673948, 1.3510270334673948, 0, 0, 0, 0, \
0.9379847120699893, -0.8913285378356101, -2.220446049250313e-16, 0, \
0, 0, 0, 2.220446049250313e-16, -0.9857599597616888, 0, 0, 0, 0, \
0.9857599597616893, 2.191505326154256, 0, -2.191505326154255, 0, 0, \
0, 0.46006694794035097, 0, -0.37293782791973373, 0, 0, 0, \
2.191505326154256, 0, 0, -2.191505326154256, 0, 0, -1.124493136164, \
0, 0, 1.4376778101628354, 0, 0, 1.3510270334673946, 0, 0, 0, \
-1.3510270334673948, 0, -1.67899150603043, 0, 0, 0, \
1.9440609251480527, 0, -0.053050677328085584, 0.2123047031357713, \
0.3506317044779759, -0.13447301853410631, 0, 0, 0.12271774790370182, \
-0.27231812257032634, -0.03893072708660447, -0.0149305733571852, 0, \
0, -0.05305067732808527, 0, -0.21812911884168168, \
0.43428780478555107, 0.21230470313577138, 0, 0.12271774790370246, 0, \
0.024218931393868333, 0.04821908512328758, 0.2723181225703261, 0, \
-0.05305067732808501, 0, 0, -0.1344730185341056, -0.132075443348447, \
0.0860536754932332, 0.12271774790370202, 0, 0, -0.014930573357185024, \
-0.1694099859261799, 0.19906085628382747;

MatrixXd Jetaphval(12,12);
Jetaphval = Jetaphmat(q);
std::cout<<"Max val Jetaphmat: "<<(Jetaphval-Jetaphtest).maxCoeff()<<std::endl;
std::cout<<"Max val Jetaphmat: "<<(Jetaphval-Jetaphtest).minCoeff()<<std::endl;

MatrixXd Jetathtest(12, 6);
Jetathtest << 0.07096848560101204, 0.07096848560101221, 0, 0, 0, 0, 0, \
-0.3359591718400785, -0.3359591718400783, 0, 0, 0, 0, 0, \
0.07096848560101171, 0.07096848560101192, 0, 0, 0, 0, 0, \
-0.33595917184007895, -0.33595917184007895, 0, 0, 0, 0, 0, \
0.07096848560101154, 0.07096848560101168, -0.33595917184007884, 0, 0, \
0, 0, -0.33595917184007884, -0.2208409615222895, 0, \
-0.8050283377127992, 0, 0, 0, -0.7608786129960214, 0, 0, \
-0.7608786129960211, 0, 0, -0.8050283377127992, 0, 0, 0, \
-0.2208409615222895, 0, -0.24661666255231662, 0.6430406760108311, \
-0.6430406760108314, 0.24661666255231643, 0, 0, -0.2466166625523168, \
0, 0.40003768696966746, -0.7964617004281822, 0.643040676010831, 0, \
-0.2466166625523165, 0, 0, 0.24661666255231662, -0.40003768696966824, \
0.4000376869696678;

MatrixXd Jetathval(12,6);
Jetathval = Jetathmat(q);
std::cout<<"Max val Jetathmat: "<<(Jetathval-Jetathtest).maxCoeff()<<std::endl;
std::cout<<"Max val Jetathmat: "<<(Jetathval-Jetathtest).minCoeff()<<std::endl;

MatrixXd dJetathtest(12, 6);
dJetathtest << 0.32672631087805465, -0.33259959109670345, 0, 0, 0, 0, 0, \
0.0850770661481002, -0.08507706614810032, 0, 0, 0, 0, 0, \
-0.05908529026513744, 0.05908529026513746, 0, 0, 0, 0, 0, \
-0.08507706614810048, 0.08507706614810044, 0, 0, 0, 0, 0, \
0.059085290265137466, -0.05908529026513744, -0.1307877251021253, 0, \
0, 0, 0, 0.1585913669796668, 0.39919608184385763, 0, \
-0.2809195068290207, 0, 0, 0, 0.18896132171245472, 0, 0, \
-0.12599177588296284, 0, 0, -0.014296174355473645, 0, 0, 0, \
0.1809195068290213, 0, 0.008095952509998549, 0.001438822923326484, \
0.04154208789708978, -0.01129187779069648, 0, 0, \
0.008095952509998505, 0, -0.025843467410703064, 0.0364677231989442, \
0.04154208789709001, 0, 0.008095952509998387, 0, 0, \
-0.011291877790696535, -0.025843467410703175, 0.03739573944350131;

MatrixXd dJetathval(12,6);
dJetathval = dJetathmat(q, dq);
std::cout<<"Max val dJetathmat: "<<(dJetathval-dJetathtest).maxCoeff()<<std::endl;
std::cout<<"Max val dJetathmat: "<<(dJetathval-dJetathtest).minCoeff()<<std::endl;

MatrixXd dJetaphtest(12, 12);
dJetaphtest << 0.015141389196768051, 0.04929365140987649, 0, 0, 0, 0, \
0.10028568945978583, -0.05035116698577485, 0, 0, 0, 0, 0, \
0.055917390326218175, 0.000260272910533349, 0, 0, 0, 0, \
0.08291859517735714, -0.07738756086080593, 0, 0, 0, 0, 0, \
0.17894942865033509, -0.17894942865033509, 0, 0, 0, 0, \
-0.0035771194513146694, -0.0035771194513147544, 0, 0, 0, 0, 0, \
0.09251991294194428, 0.00026027291053360227, 0, 0, 0, 0, \
-0.06708615329173043, 0.15497632897723873, 0, 0, 0, 0, 0, \
-0.1395964496740029, 0.17861135332597505, 0, 0, 0, 0, \
-0.1661803884910918, 0.16928712749666372, 0.08983456002270997, 0, 0, \
0, 0, -0.08983456002270997, -0.016499839404410854, 0, 0, 0, 0, \
0.07891589802284982, 0.11439545647267158, 0, 0.17962807731342462, 0, \
0, 0, 0.14617390223354745, 0, -0.20536133360677708, 0, 0, 0, \
0.2588000415599738, 0, 0, -0.049033378499343264, 0, 0, \
0.1196512314195672, 0, 0, -0.18072626356114024, 0, 0, \
0.24938053430678003, 0, 0, 0, -0.2261795801748971, 0, \
0.057263179241394624, 0, 0, 0, -0.114585417352836, 0, \
0.042353705553401996, -0.13518650809063848, 0.11978862655581947, \
-0.02695582401858284, 0, 0, 0.056348385644213454, \
-0.10775582189095995, 0.07176113272433236, -0.025873391016784417, 0, \
0, 0.04235370555340203, 0, -0.0745208925039387, 0.08705527522792164, \
-0.05488808827738463, 0, 0.05634838564421352, 0, \
-0.044642833059104325, 0.08355949996160474, -0.0895540480722517, 0, \
0.042353705553401816, 0, 0, -0.026955824018582736, \
0.03414605746698068, -0.04954393900179967, 0.056348385644213544, 0, \
0, -0.02587339101678446, 0.05571186331763353, -0.08212320755548316;

MatrixXd dJetaphval(12,12);
dJetaphval = dJetaphmat(q, dq);
std::cout<<"Max val dJetaphmat: "<<(dJetaphval-dJetaphtest).maxCoeff()<<std::endl;
std::cout<<"Max val dJetaphmat: "<<(dJetaphval-dJetaphtest).minCoeff()<<std::endl;


  return 0;
}
